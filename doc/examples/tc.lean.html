<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>A Certified Type Checker - Lean Manual</title>
        <!-- Custom HTML head -->
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">
        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="../alectryon.css">
        <link rel="stylesheet" href="../pygments.css">
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme && theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar && sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item "><a href="../whatIsLean.html"><strong aria-hidden="true">1.</strong> What is Lean</a></li><li class="chapter-item "><a href="../tour.html"><strong aria-hidden="true">2.</strong> Tour of Lean</a></li><li class="chapter-item "><a href="../quickstart.html"><strong aria-hidden="true">3.</strong> Setting Up Lean</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../setup.html"><strong aria-hidden="true">3.1.</strong> Extended Setup Notes</a></li></ol></li><li class="chapter-item "><a href="../tpil.html"><strong aria-hidden="true">4.</strong> Theorem Proving in Lean</a></li><li class="chapter-item "><a href="../fplean.html"><strong aria-hidden="true">5.</strong> Functional Programming in Lean</a></li><li class="chapter-item expanded "><a href="../examples.html"><strong aria-hidden="true">6.</strong> Examples</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../examples/palindromes.lean.html"><strong aria-hidden="true">6.1.</strong> Palindromes</a></li><li class="chapter-item "><a href="../examples/bintree.lean.html"><strong aria-hidden="true">6.2.</strong> Binary Search Trees</a></li><li class="chapter-item expanded "><a href="../examples/tc.lean.html" class="active"><strong aria-hidden="true">6.3.</strong> A Certified Type Checker</a></li><li class="chapter-item "><a href="../examples/interp.lean.html"><strong aria-hidden="true">6.4.</strong> The Well-Typed Interpreter</a></li><li class="chapter-item "><a href="../examples/deBruijn.lean.html"><strong aria-hidden="true">6.5.</strong> Dependent de Bruijn Indices</a></li><li class="chapter-item "><a href="../examples/phoas.lean.html"><strong aria-hidden="true">6.6.</strong> Parametric Higher-Order Abstract Syntax</a></li></ol></li><li class="chapter-item "><li class="part-title">Language Manual</li><li class="chapter-item "><a href="../organization.html"><strong aria-hidden="true">7.</strong> Organizational features</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../sections.html"><strong aria-hidden="true">7.1.</strong> Sections</a></li><li class="chapter-item "><a href="../namespaces.html"><strong aria-hidden="true">7.2.</strong> Namespaces</a></li><li class="chapter-item "><a href="../implicit.html"><strong aria-hidden="true">7.3.</strong> Implicit Arguments</a></li><li class="chapter-item "><a href="../autobound.html"><strong aria-hidden="true">7.4.</strong> Auto Bound Implicit Arguments</a></li></ol></li><li class="chapter-item "><a href="../syntax.html"><strong aria-hidden="true">8.</strong> Syntax Extensions</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../do.html"><strong aria-hidden="true">8.1.</strong> The do Notation</a></li><li class="chapter-item "><a href="../stringinterp.html"><strong aria-hidden="true">8.2.</strong> String Interpolation</a></li><li class="chapter-item "><a href="../notation.html"><strong aria-hidden="true">8.3.</strong> User-Defined Notation</a></li><li class="chapter-item "><a href="../macro_overview.html"><strong aria-hidden="true">8.4.</strong> Macro Overview</a></li><li class="chapter-item "><a href="../elaborators.html"><strong aria-hidden="true">8.5.</strong> Elaborators</a></li><li class="chapter-item "><a href="../syntax_examples.html"><strong aria-hidden="true">8.6.</strong> Examples</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../syntax_example.html"><strong aria-hidden="true">8.6.1.</strong> Balanced Parentheses</a></li><li class="chapter-item "><a href="../metaprogramming-arith.html"><strong aria-hidden="true">8.6.2.</strong> Arithmetic DSL</a></li></ol></li></ol></li><li class="chapter-item "><a href="../decltypes.html"><strong aria-hidden="true">9.</strong> Declaring New Types</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../enum.html"><strong aria-hidden="true">9.1.</strong> Enumerated Types</a></li><li class="chapter-item "><a href="../inductive.html"><strong aria-hidden="true">9.2.</strong> Inductive Types</a></li><li class="chapter-item "><a href="../struct.html"><strong aria-hidden="true">9.3.</strong> Structures</a></li><li class="chapter-item "><a href="../typeclass.html"><strong aria-hidden="true">9.4.</strong> Type classes</a></li><li class="chapter-item "><a href="../unifhint.html"><strong aria-hidden="true">9.5.</strong> Unification Hints</a></li></ol></li><li class="chapter-item "><a href="../builtintypes.html"><strong aria-hidden="true">10.</strong> Builtin Types</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../nat.html"><strong aria-hidden="true">10.1.</strong> Natural number</a></li><li class="chapter-item "><a href="../int.html"><strong aria-hidden="true">10.2.</strong> Integer</a></li><li class="chapter-item "><a href="../uint.html"><strong aria-hidden="true">10.3.</strong> Fixed precision unsigned integer</a></li><li class="chapter-item "><a href="../float.html"><strong aria-hidden="true">10.4.</strong> Float</a></li><li class="chapter-item "><a href="../array.html"><strong aria-hidden="true">10.5.</strong> Array</a></li><li class="chapter-item "><a href="../list.html"><strong aria-hidden="true">10.6.</strong> List</a></li><li class="chapter-item "><a href="../char.html"><strong aria-hidden="true">10.7.</strong> Character</a></li><li class="chapter-item "><a href="../string.html"><strong aria-hidden="true">10.8.</strong> String</a></li><li class="chapter-item "><a href="../option.html"><strong aria-hidden="true">10.9.</strong> Option</a></li><li class="chapter-item "><a href="../thunk.html"><strong aria-hidden="true">10.10.</strong> Thunk</a></li><li class="chapter-item "><a href="../task.html"><strong aria-hidden="true">10.11.</strong> Task and Thread</a></li></ol></li><li class="chapter-item "><a href="../functions.html"><strong aria-hidden="true">11.</strong> Functions</a></li><li class="chapter-item "><a href="../monads/intro.html"><strong aria-hidden="true">12.</strong> Monads</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../monads/functors.lean.html"><strong aria-hidden="true">12.1.</strong> Functor</a></li><li class="chapter-item "><a href="../monads/applicatives.lean.html"><strong aria-hidden="true">12.2.</strong> Applicative</a></li><li class="chapter-item "><a href="../monads/monads.lean.html"><strong aria-hidden="true">12.3.</strong> Monad</a></li><li class="chapter-item "><a href="../monads/readers.lean.html"><strong aria-hidden="true">12.4.</strong> Reader</a></li><li class="chapter-item "><a href="../monads/states.lean.html"><strong aria-hidden="true">12.5.</strong> State</a></li><li class="chapter-item "><a href="../monads/except.lean.html"><strong aria-hidden="true">12.6.</strong> Except</a></li><li class="chapter-item "><a href="../monads/transformers.lean.html"><strong aria-hidden="true">12.7.</strong> Transformers</a></li><li class="chapter-item "><a href="../monads/laws.lean.html"><strong aria-hidden="true">12.8.</strong> Laws</a></li></ol></li><li class="chapter-item "><li class="part-title">Other</li><li class="chapter-item "><a href="../faq.html"><strong aria-hidden="true">13.</strong> Frequently Asked Questions</a></li><li class="chapter-item "><a href="../lean3changes.html"><strong aria-hidden="true">14.</strong> Significant Changes from Lean 3</a></li><li class="chapter-item "><a href="../syntax_highlight_in_latex.html"><strong aria-hidden="true">15.</strong> Syntax Highlighting Lean in LaTeX</a></li><li class="chapter-item "><a href="../examples/widgets.lean.html"><strong aria-hidden="true">16.</strong> User Widgets</a></li><li class="chapter-item "><a href="../semantic_highlighting.html"><strong aria-hidden="true">17.</strong> Semantic Highlighting</a></li><li class="chapter-item affix "><li class="part-title">Development</li><li class="chapter-item "><a href="../dev/index.html"><strong aria-hidden="true">18.</strong> Development Guide</a></li><li class="chapter-item "><a href="../make/index.html"><strong aria-hidden="true">19.</strong> Building Lean</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../make/ubuntu.html"><strong aria-hidden="true">19.1.</strong> Ubuntu Setup</a></li><li class="chapter-item "><a href="../make/osx-10.9.html"><strong aria-hidden="true">19.2.</strong> macOS Setup</a></li><li class="chapter-item "><a href="../make/msys2.html"><strong aria-hidden="true">19.3.</strong> Windows MSYS2 Setup</a></li><li class="chapter-item "><a href="../make/wsl.html"><strong aria-hidden="true">19.4.</strong> Windows with WSL</a></li></ol></li><li class="chapter-item "><a href="../dev/bootstrap.html"><strong aria-hidden="true">20.</strong> Bootstrapping</a></li><li class="chapter-item "><a href="../dev/testing.html"><strong aria-hidden="true">21.</strong> Testing</a></li><li class="chapter-item "><a href="../dev/debugging.html"><strong aria-hidden="true">22.</strong> Debugging</a></li><li class="chapter-item "><a href="../dev/commit_convention.html"><strong aria-hidden="true">23.</strong> Commit Convention</a></li><li class="chapter-item "><a href="../dev/mdbook.html"><strong aria-hidden="true">24.</strong> Building This Manual</a></li><li class="chapter-item "><a href="../dev/ffi.html"><strong aria-hidden="true">25.</strong> Foreign Function Interface</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Lean Manual</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/leanprover/lean4" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="a-certified-type-checker"><a class="header" href="#a-certified-type-checker">A Certified Type Checker</a></h1>
<p>In this example, we build a certified type checker for a simple expression
language.</p>
<p>Remark: this example is based on an example in the book <a href="http://adam.chlipala.net/cpdt/">Certified Programming with Dependent Types</a> by Adam Chlipala.</p>
<pre class="alectryon-io type-info-hidden highlight"><!-- Generator: Alectryon --><span class="alectryon-wsp"><span class="alectryon-token"><span class="kd">inductive</span></span><span class="alectryon-token"> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Expr</var><b>: </b><span>Type</span></span></div></blockquote></div></small></div><span class="nv">Expr</span></span><span class="alectryon-token"> </span><span class="alectryon-token"><span class="k">where</span></span><span class="alectryon-token">
  <span class="bp">|</span> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>nat</var><b>: </b><span>Nat → Expr</span></span></div></blockquote></div></small></div>nat</span><span class="alectryon-token">  : </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Nat</var><b>: </b><span>Type</span></span></div></blockquote></div></small></div>Nat</span><span class="alectryon-token"> <span class="bp">→</span> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Expr</var><b>: </b><span>Type</span></span></div></blockquote></div></small></div><span class="nv">Expr</span></span><span class="alectryon-token">
  <span class="bp">|</span> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>plus</var><b>: </b><span>Expr → Expr → Expr</span></span></div></blockquote></div></small></div>plus</span><span class="alectryon-token"> : </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Expr</var><b>: </b><span>Type</span></span></div></blockquote></div></small></div><span class="nv">Expr</span></span><span class="alectryon-token"> <span class="bp">→</span> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Expr</var><b>: </b><span>Type</span></span></div></blockquote></div></small></div><span class="nv">Expr</span></span><span class="alectryon-token"> <span class="bp">→</span> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Expr</var><b>: </b><span>Type</span></span></div></blockquote></div></small></div><span class="nv">Expr</span></span><span class="alectryon-token">
  <span class="bp">|</span> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>bool</var><b>: </b><span>Bool → Expr</span></span></div></blockquote></div></small></div>bool</span><span class="alectryon-token"> : </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Bool</var><b>: </b><span>Type</span></span></div></blockquote></div></small></div>Bool</span><span class="alectryon-token"> <span class="bp">→</span> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Expr</var><b>: </b><span>Type</span></span></div></blockquote></div></small></div><span class="nv">Expr</span></span><span class="alectryon-token">
  <span class="bp">|</span> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>and</var><b>: </b><span>Expr → Expr → Expr</span></span></div></blockquote></div></small></div>and</span><span class="alectryon-token">  : </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Expr</var><b>: </b><span>Type</span></span></div></blockquote></div></small></div><span class="nv">Expr</span></span><span class="alectryon-token"> <span class="bp">→</span> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Expr</var><b>: </b><span>Type</span></span></div></blockquote></div></small></div><span class="nv">Expr</span></span><span class="alectryon-token"> <span class="bp">→</span> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Expr</var><b>: </b><span>Type</span></span></div></blockquote></div></small></div><span class="nv">Expr</span></span><span class="alectryon-token"></span></span></pre>
<p>We define a simple language of types using the inductive datatype <code>Ty</code>, and
its typing rules using the inductive predicate <code>HasType</code>.</p>
<pre class="alectryon-io type-info-hidden highlight"><!-- Generator: Alectryon --><span class="alectryon-wsp"><span class="alectryon-token"><span class="kd">inductive</span></span><span class="alectryon-token"> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Ty</var><b>: </b><span>Type</span></span></div></blockquote></div></small></div><span class="nv">Ty</span></span><span class="alectryon-token"> </span><span class="alectryon-token"><span class="k">where</span></span><span class="alectryon-token">
  <span class="bp">|</span> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>nat</var><b>: </b><span>Ty</span></span></div></blockquote></div></small></div>nat</span><span class="alectryon-token">
  <span class="bp">|</span> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>bool</var><b>: </b><span>Ty</span></span></div></blockquote></div></small></div>bool</span><span class="alectryon-token">
  </span><span class="alectryon-token"><span class="k">deriving</span></span><span class="alectryon-token"> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>DecidableEq</var><b>: </b><span>Sort u → Sort (max 1 u)</span></span></div></blockquote></div></small></div>DecidableEq</span><span class="alectryon-token">

</span><span class="alectryon-token"><span class="kd">inductive</span></span><span class="alectryon-token"> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>HasType</var><b>: </b><span>Expr → Ty → Prop</span></span></div></blockquote></div></small></div><span class="nv">HasType</span></span><span class="alectryon-token"> : </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Expr</var><b>: </b><span>Type</span></span></div></blockquote></div></small></div>Expr</span><span class="alectryon-token"> <span class="bp">→</span> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Ty</var><b>: </b><span>Type</span></span></div></blockquote></div></small></div>Ty</span><span class="alectryon-token"> <span class="bp">→</span> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Prop</var><b>: </b><span>Type</span></span></div></blockquote></div></small></div><span class="kt">Prop</span></span><span class="alectryon-token">
  <span class="bp">|</span> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>nat</var><b>: </b><span>∀ {v : Nat}, HasType (Expr.nat v) Ty.nat</span></span></div></blockquote></div></small></div>nat</span><span class="alectryon-token">  : </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>HasType</var><b>: </b><span>Expr → Ty → Prop</span></span></div></blockquote></div></small></div><span class="nv">HasType</span></span><span class="alectryon-token"> (</span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>.nat</var><b>: </b><span>Nat → Expr</span></span></div></blockquote></div></small></div><span class="bp">.</span>nat</span><span class="alectryon-token"> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>v</var><b>: </b><span>Nat</span></span></div></blockquote></div></small></div><span class="nv">v</span></span><span class="alectryon-token">) </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>.nat</var><b>: </b><span>Ty</span></span></div></blockquote></div></small></div><span class="bp">.</span>nat</span><span class="alectryon-token">
  <span class="bp">|</span> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>plus</var><b>: </b><span>∀ {a b : Expr}, HasType a Ty.nat → HasType b Ty.nat → HasType (Expr.plus a b) Ty.nat</span></span></div></blockquote></div></small></div>plus</span><span class="alectryon-token"> : </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>HasType</var><b>: </b><span>Expr → Ty → Prop</span></span></div></blockquote></div></small></div><span class="nv">HasType</span></span><span class="alectryon-token"> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>a</var><b>: </b><span>Expr</span></span></div></blockquote></div></small></div><span class="nv">a</span></span><span class="alectryon-token"> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>.nat</var><b>: </b><span>Ty</span></span></div></blockquote></div></small></div><span class="bp">.</span>nat</span><span class="alectryon-token"> <span class="bp">→</span> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>HasType</var><b>: </b><span>Expr → Ty → Prop</span></span></div></blockquote></div></small></div><span class="nv">HasType</span></span><span class="alectryon-token"> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>b</var><b>: </b><span>Expr</span></span></div></blockquote></div></small></div><span class="nv">b</span></span><span class="alectryon-token"> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>.nat</var><b>: </b><span>Ty</span></span></div></blockquote></div></small></div><span class="bp">.</span>nat</span><span class="alectryon-token"> <span class="bp">→</span> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>HasType</var><b>: </b><span>Expr → Ty → Prop</span></span></div></blockquote></div></small></div><span class="nv">HasType</span></span><span class="alectryon-token"> (</span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>.plus</var><b>: </b><span>Expr → Expr → Expr</span></span></div></blockquote></div></small></div><span class="bp">.</span>plus</span><span class="alectryon-token"> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>a</var><b>: </b><span>Expr</span></span></div></blockquote></div></small></div><span class="nv">a</span></span><span class="alectryon-token"> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>b</var><b>: </b><span>Expr</span></span></div></blockquote></div></small></div><span class="nv">b</span></span><span class="alectryon-token">) </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>.nat</var><b>: </b><span>Ty</span></span></div></blockquote></div></small></div><span class="bp">.</span>nat</span><span class="alectryon-token">
  <span class="bp">|</span> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>bool</var><b>: </b><span>∀ {v : Bool}, HasType (Expr.bool v) Ty.bool</span></span></div></blockquote></div></small></div>bool</span><span class="alectryon-token"> : </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>HasType</var><b>: </b><span>Expr → Ty → Prop</span></span></div></blockquote></div></small></div><span class="nv">HasType</span></span><span class="alectryon-token"> (</span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>.bool</var><b>: </b><span>Bool → Expr</span></span></div></blockquote></div></small></div><span class="bp">.</span>bool</span><span class="alectryon-token"> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>v</var><b>: </b><span>Bool</span></span></div></blockquote></div></small></div><span class="nv">v</span></span><span class="alectryon-token">) </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>.bool</var><b>: </b><span>Ty</span></span></div></blockquote></div></small></div><span class="bp">.</span>bool</span><span class="alectryon-token">
  <span class="bp">|</span> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>and</var><b>: </b><span>∀ {a b : Expr}, HasType a Ty.bool → HasType b Ty.bool → HasType (Expr.and a b) Ty.bool</span></span></div></blockquote></div></small></div>and</span><span class="alectryon-token">  : </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>HasType</var><b>: </b><span>Expr → Ty → Prop</span></span></div></blockquote></div></small></div><span class="nv">HasType</span></span><span class="alectryon-token"> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>a</var><b>: </b><span>Expr</span></span></div></blockquote></div></small></div><span class="nv">a</span></span><span class="alectryon-token"> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>.bool</var><b>: </b><span>Ty</span></span></div></blockquote></div></small></div><span class="bp">.</span>bool</span><span class="alectryon-token"> <span class="bp">→</span> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>HasType</var><b>: </b><span>Expr → Ty → Prop</span></span></div></blockquote></div></small></div><span class="nv">HasType</span></span><span class="alectryon-token"> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>b</var><b>: </b><span>Expr</span></span></div></blockquote></div></small></div><span class="nv">b</span></span><span class="alectryon-token"> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>.bool</var><b>: </b><span>Ty</span></span></div></blockquote></div></small></div><span class="bp">.</span>bool</span><span class="alectryon-token"> <span class="bp">→</span> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>HasType</var><b>: </b><span>Expr → Ty → Prop</span></span></div></blockquote></div></small></div><span class="nv">HasType</span></span><span class="alectryon-token"> (</span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>.and</var><b>: </b><span>Expr → Expr → Expr</span></span></div></blockquote></div></small></div><span class="bp">.</span>and</span><span class="alectryon-token"> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>a</var><b>: </b><span>Expr</span></span></div></blockquote></div></small></div><span class="nv">a</span></span><span class="alectryon-token"> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>b</var><b>: </b><span>Expr</span></span></div></blockquote></div></small></div><span class="nv">b</span></span><span class="alectryon-token">) </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>.bool</var><b>: </b><span>Ty</span></span></div></blockquote></div></small></div><span class="bp">.</span>bool</span><span class="alectryon-token"></span></span></pre>
<p>We can easily show that if <code>e</code> has type <code>t₁</code> and type <code>t₂</code>, then <code>t₁</code> and <code>t₂</code> must be equal
by using the the <code>cases</code> tactic. This tactic creates a new subgoal for every constructor,
and automatically discharges unreachable cases. The tactic combinator <code>tac₁ &lt;;&gt; tac₂</code> applies
<code>tac₂</code> to each subgoal produced by <code>tac₁</code>. Then, the tactic <code>rfl</code> is used to close all produced
goals using reflexivity.</p>
<pre class="alectryon-io type-info-hidden highlight"><!-- Generator: Alectryon --><span class="alectryon-wsp"><span class="alectryon-token"><span class="kd">theorem</span></span><span class="alectryon-token"> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>HasType.det</var><b>: </b><span>∀ {e : Expr} {t₁ t₂ : Ty}, HasType e t₁ → HasType e t₂ → t₁ = t₂</span></span></div></blockquote></div></small></div><span class="nv">HasType.det</span></span><span class="alectryon-token"> (</span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>h₁</var><b>: </b><span>HasType e t₁</span></span></div></blockquote></div></small></div><span class="nv">h₁</span></span><span class="alectryon-token"> : </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>HasType</var><b>: </b><span>Expr → Ty → Prop</span></span></div></blockquote></div></small></div>HasType</span><span class="alectryon-token"> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>e</var><b>: </b><span>Expr</span></span></div></blockquote></div></small></div><span class="nv">e</span></span><span class="alectryon-token"> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>t₁</var><b>: </b><span>Ty</span></span></div></blockquote></div></small></div><span class="nv">t₁</span></span><span class="alectryon-token">) (</span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>h₂</var><b>: </b><span>HasType e t₂</span></span></div></blockquote></div></small></div><span class="nv">h₂</span></span><span class="alectryon-token"> : </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>HasType</var><b>: </b><span>Expr → Ty → Prop</span></span></div></blockquote></div></small></div>HasType</span><span class="alectryon-token"> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>e</var><b>: </b><span>Expr</span></span></div></blockquote></div></small></div><span class="nv">e</span></span><span class="alectryon-token"> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>t₂</var><b>: </b><span>Ty</span></span></div></blockquote></div></small></div><span class="nv">t₂</span></span><span class="alectryon-token">) : </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>t₁</var><b>: </b><span>Ty</span></span></div></blockquote></div></small></div><span class="nv">t₁</span></span><span class="alectryon-token"> <span class="bp">=</span> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>t₂</var><b>: </b><span>Ty</span></span></div></blockquote></div></small></div><span class="nv">t₂</span></span><span class="alectryon-token"> := </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="tc-lean-chk0" style="display: none" type="checkbox"><label class="alectryon-input" for="tc-lean-chk0"><span class="alectryon-token"><span class="kd">by</span></span></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion">Goals accomplished<span class="bp">!</span> <span class="bp">🐙</span></div></blockquote></div></div></small></span><span class="alectryon-wsp"><span class="alectryon-token">
  </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="tc-lean-chk1" style="display: none" type="checkbox"><label class="alectryon-input" for="tc-lean-chk1"><span class="alectryon-token"><span class="k">cases</span></span><span class="alectryon-token"> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>h₁</var><b>: </b><span>HasType e t₁</span></span></div></blockquote></div></small></div><span class="nv">h₁</span></span></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>t₂</var><span class="hyp-type"><b>: </b><span>Ty</span></span></span><br><span><var>v✝</var><span class="hyp-type"><b>: </b><span>Nat</span></span></span><br><span><var>h₂</var><span class="hyp-type"><b>: </b><span>HasType (Expr.nat v<span class="bp">✝</span>) t₂</span></span></span><br></div><span class="goal-separator"><hr><span class="goal-name">nat</span></span><div class="goal-conclusion">Ty.nat <span class="bp">=</span> t₂</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="tc-lean-chk2" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>t₂</var><span class="hyp-type"><b>: </b><span>Ty</span></span></span><br><span><var>a✝², b✝</var><span class="hyp-type"><b>: </b><span>Expr</span></span></span><br><span><var>a✝¹</var><span class="hyp-type"><b>: </b><span>HasType a<span class="bp">✝²</span> Ty.nat</span></span></span><br><span><var>a✝</var><span class="hyp-type"><b>: </b><span>HasType b<span class="bp">✝</span> Ty.nat</span></span></span><br><span><var>h₂</var><span class="hyp-type"><b>: </b><span>HasType (Expr.plus a<span class="bp">✝²</span> b<span class="bp">✝</span>) t₂</span></span></span><br></div><label class="goal-separator" for="tc-lean-chk2"><hr><span class="goal-name">plus</span></label><div class="goal-conclusion">Ty.nat <span class="bp">=</span> t₂</div></blockquote><input class="alectryon-extra-goal-toggle" id="tc-lean-chk3" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>t₂</var><span class="hyp-type"><b>: </b><span>Ty</span></span></span><br><span><var>v✝</var><span class="hyp-type"><b>: </b><span>Bool</span></span></span><br><span><var>h₂</var><span class="hyp-type"><b>: </b><span>HasType (Expr.bool v<span class="bp">✝</span>) t₂</span></span></span><br></div><label class="goal-separator" for="tc-lean-chk3"><hr><span class="goal-name">bool</span></label><div class="goal-conclusion">Ty.bool <span class="bp">=</span> t₂</div></blockquote><input class="alectryon-extra-goal-toggle" id="tc-lean-chk4" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>t₂</var><span class="hyp-type"><b>: </b><span>Ty</span></span></span><br><span><var>a✝², b✝</var><span class="hyp-type"><b>: </b><span>Expr</span></span></span><br><span><var>a✝¹</var><span class="hyp-type"><b>: </b><span>HasType a<span class="bp">✝²</span> Ty.bool</span></span></span><br><span><var>a✝</var><span class="hyp-type"><b>: </b><span>HasType b<span class="bp">✝</span> Ty.bool</span></span></span><br><span><var>h₂</var><span class="hyp-type"><b>: </b><span>HasType (Expr.and a<span class="bp">✝²</span> b<span class="bp">✝</span>) t₂</span></span></span><br></div><label class="goal-separator" for="tc-lean-chk4"><hr><span class="goal-name">and</span></label><div class="goal-conclusion">Ty.bool <span class="bp">=</span> t₂</div></blockquote></div></div></div></small></span><span class="alectryon-wsp"><span class="alectryon-token"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="tc-lean-chk5" style="display: none" type="checkbox"><label class="alectryon-input" for="tc-lean-chk5"><span class="alectryon-token"><span class="bp">&lt;;&gt;</span></span></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>t₂</var><span class="hyp-type"><b>: </b><span>Ty</span></span></span><br><span><var>v✝</var><span class="hyp-type"><b>: </b><span>Nat</span></span></span><br><span><var>h₂</var><span class="hyp-type"><b>: </b><span>HasType (Expr.nat v<span class="bp">✝</span>) t₂</span></span></span><br></div><span class="goal-separator"><hr><span class="goal-name">nat</span></span><div class="goal-conclusion">Ty.nat <span class="bp">=</span> t₂</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="tc-lean-chk6" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>t₂</var><span class="hyp-type"><b>: </b><span>Ty</span></span></span><br><span><var>a✝², b✝</var><span class="hyp-type"><b>: </b><span>Expr</span></span></span><br><span><var>a✝¹</var><span class="hyp-type"><b>: </b><span>HasType a<span class="bp">✝²</span> Ty.nat</span></span></span><br><span><var>a✝</var><span class="hyp-type"><b>: </b><span>HasType b<span class="bp">✝</span> Ty.nat</span></span></span><br><span><var>h₂</var><span class="hyp-type"><b>: </b><span>HasType (Expr.plus a<span class="bp">✝²</span> b<span class="bp">✝</span>) t₂</span></span></span><br></div><label class="goal-separator" for="tc-lean-chk6"><hr><span class="goal-name">plus</span></label><div class="goal-conclusion">Ty.nat <span class="bp">=</span> t₂</div></blockquote><input class="alectryon-extra-goal-toggle" id="tc-lean-chk7" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>t₂</var><span class="hyp-type"><b>: </b><span>Ty</span></span></span><br><span><var>v✝</var><span class="hyp-type"><b>: </b><span>Bool</span></span></span><br><span><var>h₂</var><span class="hyp-type"><b>: </b><span>HasType (Expr.bool v<span class="bp">✝</span>) t₂</span></span></span><br></div><label class="goal-separator" for="tc-lean-chk7"><hr><span class="goal-name">bool</span></label><div class="goal-conclusion">Ty.bool <span class="bp">=</span> t₂</div></blockquote><input class="alectryon-extra-goal-toggle" id="tc-lean-chk8" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>t₂</var><span class="hyp-type"><b>: </b><span>Ty</span></span></span><br><span><var>a✝², b✝</var><span class="hyp-type"><b>: </b><span>Expr</span></span></span><br><span><var>a✝¹</var><span class="hyp-type"><b>: </b><span>HasType a<span class="bp">✝²</span> Ty.bool</span></span></span><br><span><var>a✝</var><span class="hyp-type"><b>: </b><span>HasType b<span class="bp">✝</span> Ty.bool</span></span></span><br><span><var>h₂</var><span class="hyp-type"><b>: </b><span>HasType (Expr.and a<span class="bp">✝²</span> b<span class="bp">✝</span>) t₂</span></span></span><br></div><label class="goal-separator" for="tc-lean-chk8"><hr><span class="goal-name">and</span></label><div class="goal-conclusion">Ty.bool <span class="bp">=</span> t₂</div></blockquote></div></div></div></small></span><span class="alectryon-wsp"><span class="alectryon-token"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="tc-lean-chk9" style="display: none" type="checkbox"><label class="alectryon-input" for="tc-lean-chk9"><span class="alectryon-token"><span class="k">cases</span></span><span class="alectryon-token"> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>h₂</var><b>: </b><span>HasType (Expr.nat v✝) t₂</span></span></div></blockquote></div></small></div><span class="nv">h₂</span></span></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a✝⁴, b✝</var><span class="hyp-type"><b>: </b><span>Expr</span></span></span><br><span><var>a✝³</var><span class="hyp-type"><b>: </b><span>HasType a<span class="bp">✝⁴</span> Ty.bool</span></span></span><br><span><var>a✝²</var><span class="hyp-type"><b>: </b><span>HasType b<span class="bp">✝</span> Ty.bool</span></span></span><br><span><var>a✝¹</var><span class="hyp-type"><b>: </b><span>HasType a<span class="bp">✝⁴</span> Ty.bool</span></span></span><br><span><var>a✝</var><span class="hyp-type"><b>: </b><span>HasType b<span class="bp">✝</span> Ty.bool</span></span></span><br></div><span class="goal-separator"><hr><span class="goal-name">and.and</span></span><div class="goal-conclusion">Ty.bool <span class="bp">=</span> Ty.bool</div></blockquote></div></div></small></span><span class="alectryon-wsp"><span class="alectryon-token"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="tc-lean-chka" style="display: none" type="checkbox"><label class="alectryon-input" for="tc-lean-chka"><span class="alectryon-token"><span class="bp">&lt;;&gt;</span></span></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>v✝</var><span class="hyp-type"><b>: </b><span>Nat</span></span></span><br></div><span class="goal-separator"><hr><span class="goal-name">nat.nat</span></span><div class="goal-conclusion">Ty.nat <span class="bp">=</span> Ty.nat</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="tc-lean-chkb" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a✝⁴, b✝</var><span class="hyp-type"><b>: </b><span>Expr</span></span></span><br><span><var>a✝³</var><span class="hyp-type"><b>: </b><span>HasType a<span class="bp">✝⁴</span> Ty.nat</span></span></span><br><span><var>a✝²</var><span class="hyp-type"><b>: </b><span>HasType b<span class="bp">✝</span> Ty.nat</span></span></span><br><span><var>a✝¹</var><span class="hyp-type"><b>: </b><span>HasType a<span class="bp">✝⁴</span> Ty.nat</span></span></span><br><span><var>a✝</var><span class="hyp-type"><b>: </b><span>HasType b<span class="bp">✝</span> Ty.nat</span></span></span><br></div><label class="goal-separator" for="tc-lean-chkb"><hr><span class="goal-name">plus.plus</span></label><div class="goal-conclusion">Ty.nat <span class="bp">=</span> Ty.nat</div></blockquote><input class="alectryon-extra-goal-toggle" id="tc-lean-chkc" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>v✝</var><span class="hyp-type"><b>: </b><span>Bool</span></span></span><br></div><label class="goal-separator" for="tc-lean-chkc"><hr><span class="goal-name">bool.bool</span></label><div class="goal-conclusion">Ty.bool <span class="bp">=</span> Ty.bool</div></blockquote><input class="alectryon-extra-goal-toggle" id="tc-lean-chkd" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a✝⁴, b✝</var><span class="hyp-type"><b>: </b><span>Expr</span></span></span><br><span><var>a✝³</var><span class="hyp-type"><b>: </b><span>HasType a<span class="bp">✝⁴</span> Ty.bool</span></span></span><br><span><var>a✝²</var><span class="hyp-type"><b>: </b><span>HasType b<span class="bp">✝</span> Ty.bool</span></span></span><br><span><var>a✝¹</var><span class="hyp-type"><b>: </b><span>HasType a<span class="bp">✝⁴</span> Ty.bool</span></span></span><br><span><var>a✝</var><span class="hyp-type"><b>: </b><span>HasType b<span class="bp">✝</span> Ty.bool</span></span></span><br></div><label class="goal-separator" for="tc-lean-chkd"><hr><span class="goal-name">and.and</span></label><div class="goal-conclusion">Ty.bool <span class="bp">=</span> Ty.bool</div></blockquote></div></div></div></small></span><span class="alectryon-wsp"><span class="alectryon-token"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="tc-lean-chke" style="display: none" type="checkbox"><label class="alectryon-input" for="tc-lean-chke"><span class="alectryon-token"><span class="k">rfl</span></span></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion">Goals accomplished<span class="bp">!</span> <span class="bp">🐙</span></div></blockquote></div></div></small></span></pre>
<p>The inductive type <code>Maybe p</code> has two constructors: <code>found a h</code> and <code>unknown</code>.
The former contains an element <code>a : α</code> and a proof that <code>a</code> satisfies the predicate <code>p</code>.
The constructor <code>unknown</code> is used to encode &quot;failure&quot;.</p>
<pre class="alectryon-io type-info-hidden highlight"><!-- Generator: Alectryon --><span class="alectryon-wsp"><span class="alectryon-token"><span class="kd">inductive</span></span><span class="alectryon-token"> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Maybe</var><b>: </b><span>{α : Sort u_1} → (α → Prop) → Sort (max 1 u_1)</span></span></div></blockquote></div></small></div><span class="nv">Maybe</span></span><span class="alectryon-token"> (</span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>p</var><b>: </b><span>α → Prop</span></span></div></blockquote></div></small></div><span class="nv">p</span></span><span class="alectryon-token"> : </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>α</var><b>: </b><span>Sort u_1</span></span></div></blockquote></div></small></div><span class="nv">α</span></span><span class="alectryon-token"> <span class="bp">→</span> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Prop</var><b>: </b><span>Type</span></span></div></blockquote></div></small></div><span class="kt">Prop</span></span><span class="alectryon-token">) </span><span class="alectryon-token"><span class="k">where</span></span><span class="alectryon-token">
  <span class="bp">|</span> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>found</var><b>: </b><span>{α : Sort u_1} → {p : α → Prop} → (a : α) → p a → Maybe p</span></span></div></blockquote></div></small></div>found</span><span class="alectryon-token"> : (</span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>a</var><b>: </b><span>α</span></span></div></blockquote></div></small></div><span class="nv">a</span></span><span class="alectryon-token"> : </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>α</var><b>: </b><span>Sort u_1</span></span></div></blockquote></div></small></div><span class="nv">α</span></span><span class="alectryon-token">) <span class="bp">→</span> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>p</var><b>: </b><span>α → Prop</span></span></div></blockquote></div></small></div><span class="nv">p</span></span><span class="alectryon-token"> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>a</var><b>: </b><span>α</span></span></div></blockquote></div></small></div><span class="nv">a</span></span><span class="alectryon-token"> <span class="bp">→</span> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Maybe</var><b>: </b><span>{α : Sort u_1} → (α → Prop) → Sort (max 1 u_1)</span></span></div></blockquote></div></small></div><span class="nv">Maybe</span></span><span class="alectryon-token"> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>p</var><b>: </b><span>α → Prop</span></span></div></blockquote></div></small></div><span class="nv">p</span></span><span class="alectryon-token">
  <span class="bp">|</span> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>unknown</var><b>: </b><span>{α : Sort u_1} → {p : α → Prop} → Maybe p</span></span></div></blockquote></div></small></div>unknown</span><span class="alectryon-token"></span></span></pre>
<p>We define a notation for <code>Maybe</code> that is similar to the builtin notation for the Lean builtin type <code>Subtype</code>.</p>
<pre class="alectryon-io type-info-hidden highlight"><!-- Generator: Alectryon --><span class="alectryon-wsp"><span class="alectryon-token"><span class="kd">notation</span></span><span class="alectryon-token"> <span class="s2">&quot;{{ &quot;</span> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>x</var><b>: </b><span>Lean.TSyntax `term</span></span></div></blockquote></div></small></div><span class="nv">x</span></span><span class="alectryon-token"> <span class="s2">&quot; | &quot;</span> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>p</var><b>: </b><span>Lean.TSyntax `term</span></span></div></blockquote></div></small></div><span class="nv">p</span></span><span class="alectryon-token"> <span class="s2">&quot; }}&quot;</span> <span class="bp">=&gt;</span> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Maybe</var><b>: </b><span>{α : Sort u_1} → (α → Prop) → Sort (max 1 u_1)</span></span></div></blockquote></div></small></div>Maybe</span><span class="alectryon-token"> (</span><span class="alectryon-token"><span class="k">fun</span></span><span class="alectryon-token"> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>x</var><b>: </b><span>Lean.TSyntax `term</span></span></div></blockquote></div></small></div><span class="nv">x</span></span><span class="alectryon-token"> <span class="bp">=&gt;</span> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>p</var><b>: </b><span>Lean.TSyntax `term</span></span></div></blockquote></div></small></div><span class="nv">p</span></span><span class="alectryon-token">)</span></span></pre>
<p>The function <code>Expr.typeCheck e</code> returns a type <code>ty</code> and a proof that <code>e</code> has type <code>ty</code>,
or <code>unknown</code>.
Recall that, <code>def Expr.typeCheck ...</code> in Lean is notation for <code>namespace Expr def typeCheck ... end Expr</code>.
The term <code>.found .nat .nat</code> is sugar for <code>Maybe.found Ty.nat HasType.nat</code>. Lean can infer the namespaces using
the expected types.</p>
<pre class="alectryon-io type-info-hidden highlight"><!-- Generator: Alectryon --><span class="alectryon-wsp"><span class="alectryon-token"><span class="kd">def</span></span><span class="alectryon-token"> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Expr.typeCheck</var><b>: </b><span>(e : Expr) → {{ ty | HasType e ty }}</span></span></div></blockquote></div></small></div><span class="nv">Expr.typeCheck</span></span><span class="alectryon-token"> (</span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>e</var><b>: </b><span>Expr</span></span></div></blockquote></div></small></div><span class="nv">e</span></span><span class="alectryon-token"> : </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Expr</var><b>: </b><span>Type</span></span></div></blockquote></div></small></div>Expr</span><span class="alectryon-token">) : {{ </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>ty</var><b>: </b><span>Ty</span></span></div></blockquote></div></small></div><span class="nv">ty</span></span><span class="alectryon-token"> <span class="bp">|</span> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>HasType</var><b>: </b><span>Expr → Ty → Prop</span></span></div></blockquote></div></small></div>HasType</span><span class="alectryon-token"> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>e</var><b>: </b><span>Expr</span></span></div></blockquote></div></small></div><span class="nv">e</span></span><span class="alectryon-token"> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>ty</var><b>: </b><span>Ty</span></span></div></blockquote></div></small></div><span class="nv">ty</span></span><span class="alectryon-token"> }} :=
  </span><span class="alectryon-token"><span class="k">match</span></span><span class="alectryon-token"> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>e</var><b>: </b><span>Expr</span></span></div></blockquote></div></small></div><span class="nv">e</span></span><span class="alectryon-token"> </span><span class="alectryon-token"><span class="k">with</span></span><span class="alectryon-token">
  <span class="bp">|</span> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>nat</var><b>: </b><span>Nat → Expr</span></span></div></blockquote></div></small></div>nat</span><span class="alectryon-token"> <span class="bp">..</span>   <span class="bp">=&gt;</span> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>.found</var><b>: </b><span>{α : Type} → {p : α → Prop} → (a : α) → p a → Maybe p</span></span></div></blockquote></div></small></div><span class="bp">.</span>found</span><span class="alectryon-token"> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>.nat</var><b>: </b><span>Ty</span></span></div></blockquote></div></small></div><span class="bp">.</span>nat</span><span class="alectryon-token"> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>.nat</var><b>: </b><span>∀ {v : Nat}, HasType (nat v) Ty.nat</span></span></div></blockquote></div></small></div><span class="bp">.</span>nat</span><span class="alectryon-token">
  <span class="bp">|</span> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>bool</var><b>: </b><span>Bool → Expr</span></span></div></blockquote></div></small></div>bool</span><span class="alectryon-token"> <span class="bp">..</span>  <span class="bp">=&gt;</span> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>.found</var><b>: </b><span>{α : Type} → {p : α → Prop} → (a : α) → p a → Maybe p</span></span></div></blockquote></div></small></div><span class="bp">.</span>found</span><span class="alectryon-token"> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>.bool</var><b>: </b><span>Ty</span></span></div></blockquote></div></small></div><span class="bp">.</span>bool</span><span class="alectryon-token"> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>.bool</var><b>: </b><span>∀ {v : Bool}, HasType (bool v) Ty.bool</span></span></div></blockquote></div></small></div><span class="bp">.</span>bool</span><span class="alectryon-token">
  <span class="bp">|</span> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>plus</var><b>: </b><span>Expr → Expr → Expr</span></span></div></blockquote></div></small></div>plus</span><span class="alectryon-token"> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>a</var><b>: </b><span>Expr</span></span></div></blockquote></div></small></div><span class="nv">a</span></span><span class="alectryon-token"> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>b</var><b>: </b><span>Expr</span></span></div></blockquote></div></small></div><span class="nv">b</span></span><span class="alectryon-token"> <span class="bp">=&gt;</span>
    </span><span class="alectryon-token"><span class="k">match</span></span><span class="alectryon-token"> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>a</var><b>: </b><span>Expr</span></span></div></blockquote></div></small></div><span class="nv">a</span></span><span class="alectryon-token"><span class="bp">.</span></span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>typeCheck</var><b>: </b><span>(e : Expr) → {{ ty | HasType e ty }}</span></span></div></blockquote></div></small></div><span class="nv">typeCheck</span></span><span class="alectryon-token">, </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>b</var><b>: </b><span>Expr</span></span></div></blockquote></div></small></div><span class="nv">b</span></span><span class="alectryon-token"><span class="bp">.</span></span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>typeCheck</var><b>: </b><span>(e : Expr) → {{ ty | HasType e ty }}</span></span></div></blockquote></div></small></div><span class="nv">typeCheck</span></span><span class="alectryon-token"> </span><span class="alectryon-token"><span class="k">with</span></span><span class="alectryon-token">
    <span class="bp">|</span> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>.found</var><b>: </b><span>{α : Type} → {p : α → Prop} → (a : α) → p a → Maybe p</span></span></div></blockquote></div></small></div><span class="bp">.</span>found</span><span class="alectryon-token"> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>.nat</var><b>: </b><span>Ty</span></span></div></blockquote></div></small></div><span class="bp">.</span>nat</span><span class="alectryon-token"> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>h₁</var><b>: </b><span>HasType a Ty.nat</span></span></div></blockquote></div></small></div><span class="nv">h₁</span></span><span class="alectryon-token">, </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>.found</var><b>: </b><span>{α : Type} → {p : α → Prop} → (a : α) → p a → Maybe p</span></span></div></blockquote></div></small></div><span class="bp">.</span>found</span><span class="alectryon-token"> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>.nat</var><b>: </b><span>Ty</span></span></div></blockquote></div></small></div><span class="bp">.</span>nat</span><span class="alectryon-token"> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>h₂</var><b>: </b><span>HasType b Ty.nat</span></span></div></blockquote></div></small></div><span class="nv">h₂</span></span><span class="alectryon-token"> <span class="bp">=&gt;</span> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>.found</var><b>: </b><span>{α : Type} → {p : α → Prop} → (a : α) → p a → Maybe p</span></span></div></blockquote></div></small></div><span class="bp">.</span>found</span><span class="alectryon-token"> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>.nat</var><b>: </b><span>Ty</span></span></div></blockquote></div></small></div><span class="bp">.</span>nat</span><span class="alectryon-token"> (</span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>.plus</var><b>: </b><span>∀ {a b : Expr}, HasType a Ty.nat → HasType b Ty.nat → HasType (plus a b) Ty.nat</span></span></div></blockquote></div></small></div><span class="bp">.</span>plus</span><span class="alectryon-token"> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>h₁</var><b>: </b><span>HasType a Ty.nat</span></span></div></blockquote></div></small></div><span class="nv">h₁</span></span><span class="alectryon-token"> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>h₂</var><b>: </b><span>HasType b Ty.nat</span></span></div></blockquote></div></small></div><span class="nv">h₂</span></span><span class="alectryon-token">)
    <span class="bp">|</span> _, _ <span class="bp">=&gt;</span> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>.unknown</var><b>: </b><span>{α : Type} → {p : α → Prop} → Maybe p</span></span></div></blockquote></div></small></div><span class="bp">.</span>unknown</span><span class="alectryon-token">
  <span class="bp">|</span> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>and</var><b>: </b><span>Expr → Expr → Expr</span></span></div></blockquote></div></small></div>and</span><span class="alectryon-token"> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>a</var><b>: </b><span>Expr</span></span></div></blockquote></div></small></div><span class="nv">a</span></span><span class="alectryon-token"> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>b</var><b>: </b><span>Expr</span></span></div></blockquote></div></small></div><span class="nv">b</span></span><span class="alectryon-token"> <span class="bp">=&gt;</span>
    </span><span class="alectryon-token"><span class="k">match</span></span><span class="alectryon-token"> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>a</var><b>: </b><span>Expr</span></span></div></blockquote></div></small></div><span class="nv">a</span></span><span class="alectryon-token"><span class="bp">.</span></span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>typeCheck</var><b>: </b><span>(e : Expr) → {{ ty | HasType e ty }}</span></span></div></blockquote></div></small></div><span class="nv">typeCheck</span></span><span class="alectryon-token">, </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>b</var><b>: </b><span>Expr</span></span></div></blockquote></div></small></div><span class="nv">b</span></span><span class="alectryon-token"><span class="bp">.</span></span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>typeCheck</var><b>: </b><span>(e : Expr) → {{ ty | HasType e ty }}</span></span></div></blockquote></div></small></div><span class="nv">typeCheck</span></span><span class="alectryon-token"> </span><span class="alectryon-token"><span class="k">with</span></span><span class="alectryon-token">
    <span class="bp">|</span> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>.found</var><b>: </b><span>{α : Type} → {p : α → Prop} → (a : α) → p a → Maybe p</span></span></div></blockquote></div></small></div><span class="bp">.</span>found</span><span class="alectryon-token"> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>.bool</var><b>: </b><span>Ty</span></span></div></blockquote></div></small></div><span class="bp">.</span>bool</span><span class="alectryon-token"> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>h₁</var><b>: </b><span>HasType a Ty.bool</span></span></div></blockquote></div></small></div><span class="nv">h₁</span></span><span class="alectryon-token">, </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>.found</var><b>: </b><span>{α : Type} → {p : α → Prop} → (a : α) → p a → Maybe p</span></span></div></blockquote></div></small></div><span class="bp">.</span>found</span><span class="alectryon-token"> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>.bool</var><b>: </b><span>Ty</span></span></div></blockquote></div></small></div><span class="bp">.</span>bool</span><span class="alectryon-token"> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>h₂</var><b>: </b><span>HasType b Ty.bool</span></span></div></blockquote></div></small></div><span class="nv">h₂</span></span><span class="alectryon-token"> <span class="bp">=&gt;</span> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>.found</var><b>: </b><span>{α : Type} → {p : α → Prop} → (a : α) → p a → Maybe p</span></span></div></blockquote></div></small></div><span class="bp">.</span>found</span><span class="alectryon-token"> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>.bool</var><b>: </b><span>Ty</span></span></div></blockquote></div></small></div><span class="bp">.</span>bool</span><span class="alectryon-token"> (</span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>.and</var><b>: </b><span>∀ {a b : Expr}, HasType a Ty.bool → HasType b Ty.bool → HasType (and a b) Ty.bool</span></span></div></blockquote></div></small></div><span class="bp">.</span>and</span><span class="alectryon-token"> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>h₁</var><b>: </b><span>HasType a Ty.bool</span></span></div></blockquote></div></small></div><span class="nv">h₁</span></span><span class="alectryon-token"> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>h₂</var><b>: </b><span>HasType b Ty.bool</span></span></div></blockquote></div></small></div><span class="nv">h₂</span></span><span class="alectryon-token">)
    <span class="bp">|</span> _, _ <span class="bp">=&gt;</span> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>.unknown</var><b>: </b><span>{α : Type} → {p : α → Prop} → Maybe p</span></span></div></blockquote></div></small></div><span class="bp">.</span>unknown</span><span class="alectryon-token">

</span><span class="alectryon-token"><span class="kd">theorem</span></span><span class="alectryon-token"> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Expr.typeCheck_correct</var><b>: </b><span>∀ {e : Expr} {ty : Ty} {h : HasType e ty}, HasType e ty → typeCheck e ≠ Maybe.unknown → typeCheck e = Maybe.found ty h</span></span></div></blockquote></div></small></div><span class="nv">Expr.typeCheck_correct</span></span><span class="alectryon-token"> (</span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>h₁</var><b>: </b><span>HasType e ty</span></span></div></blockquote></div></small></div><span class="nv">h₁</span></span><span class="alectryon-token"> : </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>HasType</var><b>: </b><span>Expr → Ty → Prop</span></span></div></blockquote></div></small></div>HasType</span><span class="alectryon-token"> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>e</var><b>: </b><span>Expr</span></span></div></blockquote></div></small></div><span class="nv">e</span></span><span class="alectryon-token"> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>ty</var><b>: </b><span>Ty</span></span></div></blockquote></div></small></div><span class="nv">ty</span></span><span class="alectryon-token">) (</span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>h₂</var><b>: </b><span>typeCheck e ≠ Maybe.unknown</span></span></div></blockquote></div></small></div><span class="nv">h₂</span></span><span class="alectryon-token"> : </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>e</var><b>: </b><span>Expr</span></span></div></blockquote></div></small></div><span class="nv">e</span></span><span class="alectryon-token"><span class="bp">.</span></span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>typeCheck</var><b>: </b><span>(e : Expr) → {{ ty | HasType e ty }}</span></span></div></blockquote></div></small></div>typeCheck</span><span class="alectryon-token"> <span class="bp">≠</span> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>.unknown</var><b>: </b><span>{α : Sort ?u.7978} → {p : α → Prop} → Maybe p</span></span></div></blockquote></div></small></div><span class="bp">.</span>unknown</span><span class="alectryon-token">)
        : </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>e</var><b>: </b><span>Expr</span></span></div></blockquote></div></small></div><span class="nv">e</span></span><span class="alectryon-token"><span class="bp">.</span></span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>typeCheck</var><b>: </b><span>(e : Expr) → {{ ty | HasType e ty }}</span></span></div></blockquote></div></small></div>typeCheck</span><span class="alectryon-token"> <span class="bp">=</span> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>.found</var><b>: </b><span>{α : Type} → {p : α → Prop} → (a : α) → p a → Maybe p</span></span></div></blockquote></div></small></div><span class="bp">.</span>found</span><span class="alectryon-token"> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>ty</var><b>: </b><span>Ty</span></span></div></blockquote></div></small></div><span class="nv">ty</span></span><span class="alectryon-token"> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>h</var><b>: </b><span>HasType e ty</span></span></div></blockquote></div></small></div><span class="nv">h</span></span><span class="alectryon-token"> := </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="tc-lean-chkf" style="display: none" type="checkbox"><label class="alectryon-input" for="tc-lean-chkf"><span class="alectryon-token"><span class="kd">by</span></span></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion">Goals accomplished<span class="bp">!</span> <span class="bp">🐙</span></div></blockquote></div></div></small></span><span class="alectryon-wsp"><span class="alectryon-token">
  </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="tc-lean-chk10" style="display: none" type="checkbox"><label class="alectryon-input" for="tc-lean-chk10"><span class="alectryon-token"><span class="k">revert</span></span><span class="alectryon-token"> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>h₂</var><b>: </b><span>typeCheck e ≠ Maybe.unknown</span></span></div></blockquote></div></small></div><span class="nv">h₂</span></span></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>e</var><span class="hyp-type"><b>: </b><span>Expr</span></span></span><br><span><var>ty</var><span class="hyp-type"><b>: </b><span>Ty</span></span></span><br><span><var>h, h₁</var><span class="hyp-type"><b>: </b><span>HasType e ty</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">typeCheck e <span class="bp">≠</span> Maybe.unknown <span class="bp">→</span> typeCheck e <span class="bp">=</span> Maybe.found ty h</div></blockquote></div></div></small></span><span class="alectryon-wsp"><span class="alectryon-token">
  </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="tc-lean-chk11" style="display: none" type="checkbox"><label class="alectryon-input" for="tc-lean-chk11"><span class="alectryon-token"><span class="k">cases</span></span><span class="alectryon-token"> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>typeCheck</var><b>: </b><span>(e : Expr) → {{ ty | HasType e ty }}</span></span></div></blockquote></div></small></div>typeCheck</span><span class="alectryon-token"> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>e</var><b>: </b><span>Expr</span></span></div></blockquote></div></small></div><span class="nv">e</span></span><span class="alectryon-token"> </span><span class="alectryon-token"><span class="k">with</span></span><span class="alectryon-token"></span></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>e</var><span class="hyp-type"><b>: </b><span>Expr</span></span></span><br><span><var>ty</var><span class="hyp-type"><b>: </b><span>Ty</span></span></span><br><span><var>h, h₁</var><span class="hyp-type"><b>: </b><span>HasType e ty</span></span></span><br><span><var>x✝</var><span class="hyp-type"><b>: </b><span>{{ ty <span class="bp">|</span> HasType e ty }}</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">x<span class="bp">✝</span> <span class="bp">≠</span> Maybe.unknown <span class="bp">→</span> x<span class="bp">✝</span> <span class="bp">=</span> Maybe.found ty h</div></blockquote></div></div></small></span><span class="alectryon-wsp"><span class="alectryon-token">
  </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="tc-lean-chk12" style="display: none" type="checkbox"><label class="alectryon-input" for="tc-lean-chk12"><span class="alectryon-token"><span class="bp">|</span> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>found</var><b>: </b><span>{α : Sort u_1} → {p : α → Prop} → (a : α) → p a → Maybe p</span></span></div></blockquote></div></small></div>found</span><span class="alectryon-token"> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>ty'</var><b>: </b><span>Ty</span></span></div></blockquote></div></small></div><span class="nv">ty&#39;</span></span><span class="alectryon-token"> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>h'</var><b>: </b><span>HasType e ty'</span></span></div></blockquote></div></small></div><span class="nv">h&#39;</span></span><span class="alectryon-token"> <span class="bp">=&gt;</span></span></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>e</var><span class="hyp-type"><b>: </b><span>Expr</span></span></span><br><span><var>ty</var><span class="hyp-type"><b>: </b><span>Ty</span></span></span><br><span><var>h, h₁</var><span class="hyp-type"><b>: </b><span>HasType e ty</span></span></span><br><span><var>ty'</var><span class="hyp-type"><b>: </b><span>Ty</span></span></span><br><span><var>h'</var><span class="hyp-type"><b>: </b><span>HasType e ty&#39;</span></span></span><br></div><span class="goal-separator"><hr><span class="goal-name">found</span></span><div class="goal-conclusion">Maybe.found ty&#39; h&#39; <span class="bp">≠</span> Maybe.unknown <span class="bp">→</span> Maybe.found ty&#39; h&#39; <span class="bp">=</span> Maybe.found ty h</div></blockquote></div></div></small></span><span class="alectryon-wsp"><span class="alectryon-token"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="tc-lean-chk13" style="display: none" type="checkbox"><label class="alectryon-input" for="tc-lean-chk13"><span class="alectryon-token"><span class="k">intro</span></span></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>e</var><span class="hyp-type"><b>: </b><span>Expr</span></span></span><br><span><var>ty</var><span class="hyp-type"><b>: </b><span>Ty</span></span></span><br><span><var>h, h₁</var><span class="hyp-type"><b>: </b><span>HasType e ty</span></span></span><br><span><var>ty'</var><span class="hyp-type"><b>: </b><span>Ty</span></span></span><br><span><var>h'</var><span class="hyp-type"><b>: </b><span>HasType e ty&#39;</span></span></span><br><span><var>h₂✝</var><span class="hyp-type"><b>: </b><span>Maybe.found ty&#39; h&#39; <span class="bp">≠</span> Maybe.unknown</span></span></span><br></div><span class="goal-separator"><hr><span class="goal-name">found</span></span><div class="goal-conclusion">Maybe.found ty&#39; h&#39; <span class="bp">=</span> Maybe.found ty h</div></blockquote></div></div></small></span><span class="alectryon-wsp"><span class="alectryon-token"><span class="bp">;</span></span><span class="alectryon-token"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="tc-lean-chk14" style="display: none" type="checkbox"><label class="alectryon-input" for="tc-lean-chk14"><span class="alectryon-token"><span class="k">have</span></span><span class="alectryon-token"> := </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>HasType.det</var><b>: </b><span>∀ {e : Expr} {t₁ t₂ : Ty}, HasType e t₁ → HasType e t₂ → t₁ = t₂</span></span></div></blockquote></div></small></div>HasType.det</span><span class="alectryon-token"> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>h₁</var><b>: </b><span>HasType e ty</span></span></div></blockquote></div></small></div><span class="nv">h₁</span></span><span class="alectryon-token"> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>h'</var><b>: </b><span>HasType e ty'</span></span></div></blockquote></div></small></div><span class="nv">h&#39;</span></span></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>e</var><span class="hyp-type"><b>: </b><span>Expr</span></span></span><br><span><var>ty</var><span class="hyp-type"><b>: </b><span>Ty</span></span></span><br><span><var>h, h₁</var><span class="hyp-type"><b>: </b><span>HasType e ty</span></span></span><br><span><var>ty'</var><span class="hyp-type"><b>: </b><span>Ty</span></span></span><br><span><var>h'</var><span class="hyp-type"><b>: </b><span>HasType e ty&#39;</span></span></span><br><span><var>h₂✝</var><span class="hyp-type"><b>: </b><span>Maybe.found ty&#39; h&#39; <span class="bp">≠</span> Maybe.unknown</span></span></span><br><span><var>this</var><span class="hyp-type"><b>: </b><span>ty <span class="bp">=</span> ty&#39;</span></span></span><br></div><span class="goal-separator"><hr><span class="goal-name">found</span></span><div class="goal-conclusion">Maybe.found ty&#39; h&#39; <span class="bp">=</span> Maybe.found ty h</div></blockquote></div></div></small></span><span class="alectryon-wsp"><span class="alectryon-token"><span class="bp">;</span></span><span class="alectryon-token"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="tc-lean-chk15" style="display: none" type="checkbox"><label class="alectryon-input" for="tc-lean-chk15"><span class="alectryon-token"><span class="k">subst</span></span><span class="alectryon-token"> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>this</var><b>: </b><span>ty = ty'</span></span></div></blockquote></div></small></div><span class="nv">this</span></span></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>e</var><span class="hyp-type"><b>: </b><span>Expr</span></span></span><br><span><var>ty</var><span class="hyp-type"><b>: </b><span>Ty</span></span></span><br><span><var>h, h₁, h'</var><span class="hyp-type"><b>: </b><span>HasType e ty</span></span></span><br><span><var>h₂✝</var><span class="hyp-type"><b>: </b><span>Maybe.found ty h&#39; <span class="bp">≠</span> Maybe.unknown</span></span></span><br></div><span class="goal-separator"><hr><span class="goal-name">found</span></span><div class="goal-conclusion">Maybe.found ty h&#39; <span class="bp">=</span> Maybe.found ty h</div></blockquote></div></div></small></span><span class="alectryon-wsp"><span class="alectryon-token"><span class="bp">;</span></span><span class="alectryon-token"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="tc-lean-chk16" style="display: none" type="checkbox"><label class="alectryon-input" for="tc-lean-chk16"><span class="alectryon-token"><span class="k">rfl</span></span></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion">Goals accomplished<span class="bp">!</span> <span class="bp">🐙</span></div></blockquote></div></div></small></span><span class="alectryon-wsp"><span class="alectryon-token">
  </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="tc-lean-chk17" style="display: none" type="checkbox"><label class="alectryon-input" for="tc-lean-chk17"><span class="alectryon-token"><span class="bp">|</span> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>unknown</var><b>: </b><span>{α : Sort u_1} → {p : α → Prop} → Maybe p</span></span></div></blockquote></div></small></div>unknown</span><span class="alectryon-token"> <span class="bp">=&gt;</span></span></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>e</var><span class="hyp-type"><b>: </b><span>Expr</span></span></span><br><span><var>ty</var><span class="hyp-type"><b>: </b><span>Ty</span></span></span><br><span><var>h, h₁</var><span class="hyp-type"><b>: </b><span>HasType e ty</span></span></span><br></div><span class="goal-separator"><hr><span class="goal-name">unknown</span></span><div class="goal-conclusion">Maybe.unknown <span class="bp">≠</span> Maybe.unknown <span class="bp">→</span> Maybe.unknown <span class="bp">=</span> Maybe.found ty h</div></blockquote></div></div></small></span><span class="alectryon-wsp"><span class="alectryon-token"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="tc-lean-chk18" style="display: none" type="checkbox"><label class="alectryon-input" for="tc-lean-chk18"><span class="alectryon-token"><span class="k">intros</span></span></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>e</var><span class="hyp-type"><b>: </b><span>Expr</span></span></span><br><span><var>ty</var><span class="hyp-type"><b>: </b><span>Ty</span></span></span><br><span><var>h, h₁</var><span class="hyp-type"><b>: </b><span>HasType e ty</span></span></span><br><span><var>h₂✝</var><span class="hyp-type"><b>: </b><span>Maybe.unknown <span class="bp">≠</span> Maybe.unknown</span></span></span><br></div><span class="goal-separator"><hr><span class="goal-name">unknown</span></span><div class="goal-conclusion">Maybe.unknown <span class="bp">=</span> Maybe.found ty h</div></blockquote></div></div></small></span><span class="alectryon-wsp"><span class="alectryon-token"><span class="bp">;</span></span><span class="alectryon-token"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="tc-lean-chk19" style="display: none" type="checkbox"><label class="alectryon-input" for="tc-lean-chk19"><span class="alectryon-token"><span class="k">contradiction</span></span></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion">Goals accomplished<span class="bp">!</span> <span class="bp">🐙</span></div></blockquote></div></div></small></span></pre>
<p>Now, we prove that if <code>Expr.typeCheck e</code> returns <code>Maybe.unknown</code>, then forall <code>ty</code>, <code>HasType e ty</code> does not hold.
The notation <code>e.typeCheck</code> is sugar for <code>Expr.typeCheck e</code>. Lean can infer this because we explicitly said that <code>e</code> has type <code>Expr</code>.
The proof is by induction on <code>e</code> and case analysis. The tactic <code>rename_i</code> is used to to rename &quot;inaccessible&quot; variables.
We say a variable is inaccessible if it is introduced by a tactic (e.g., <code>cases</code>) or has been shadowed by another variable introduced
by the user. Note that the tactic <code>simp [typeCheck]</code> is applied to all goal generated by the <code>induction</code> tactic, and closes
the cases corresponding to the constructors <code>Expr.nat</code> and <code>Expr.bool</code>.</p>
<pre class="alectryon-io type-info-hidden highlight"><!-- Generator: Alectryon --><span class="alectryon-wsp"><span class="alectryon-token"><span class="kd">theorem</span></span><span class="alectryon-token"> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Expr.typeCheck_complete</var><b>: </b><span>∀ {ty : Ty} {e : Expr}, typeCheck e = Maybe.unknown → ¬HasType e ty</span></span></div></blockquote></div></small></div><span class="nv">Expr.typeCheck_complete</span></span><span class="alectryon-token"> {</span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>e</var><b>: </b><span>Expr</span></span></div></blockquote></div></small></div><span class="nv">e</span></span><span class="alectryon-token"> : </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Expr</var><b>: </b><span>Type</span></span></div></blockquote></div></small></div>Expr</span><span class="alectryon-token">} : </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>e</var><b>: </b><span>Expr</span></span></div></blockquote></div></small></div><span class="nv">e</span></span><span class="alectryon-token"><span class="bp">.</span></span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>typeCheck</var><b>: </b><span>(e : Expr) → {{ ty | HasType e ty }}</span></span></div></blockquote></div></small></div>typeCheck</span><span class="alectryon-token"> <span class="bp">=</span> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>.unknown</var><b>: </b><span>{α : Type} → {p : α → Prop} → Maybe p</span></span></div></blockquote></div></small></div><span class="bp">.</span>unknown</span><span class="alectryon-token"> <span class="bp">→</span> <span class="bp">¬</span> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>HasType</var><b>: </b><span>Expr → Ty → Prop</span></span></div></blockquote></div></small></div>HasType</span><span class="alectryon-token"> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>e</var><b>: </b><span>Expr</span></span></div></blockquote></div></small></div><span class="nv">e</span></span><span class="alectryon-token"> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>ty</var><b>: </b><span>Ty</span></span></div></blockquote></div></small></div><span class="nv">ty</span></span><span class="alectryon-token"> := </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="tc-lean-chk1a" style="display: none" type="checkbox"><label class="alectryon-input" for="tc-lean-chk1a"><span class="alectryon-token"><span class="kd">by</span></span></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion">Goals accomplished<span class="bp">!</span> <span class="bp">🐙</span></div></blockquote></div></div></small></span><span class="alectryon-wsp"><span class="alectryon-token">
  </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="tc-lean-chk1b" style="display: none" type="checkbox"><label class="alectryon-input" for="tc-lean-chk1b"><span class="alectryon-token"><span class="k">induction</span></span><span class="alectryon-token"> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>e</var><b>: </b><span>Expr</span></span></div></blockquote></div></small></div><span class="nv">e</span></span><span class="alectryon-token"> </span><span class="alectryon-token"><span class="k">with</span></span><span class="alectryon-token"></span></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ty</var><span class="hyp-type"><b>: </b><span>Ty</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>Expr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">typeCheck e <span class="bp">=</span> Maybe.unknown <span class="bp">→</span> <span class="bp">¬</span>HasType e ty</div></blockquote></div></div></small></span><span class="alectryon-wsp"><span class="alectryon-token"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="tc-lean-chk1c" style="display: none" type="checkbox"><label class="alectryon-input" for="tc-lean-chk1c"><span class="alectryon-token"><span class="k">simp</span></span><span class="alectryon-token"> [</span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>typeCheck</var><b>: </b><span>(e : Expr) → {{ ty | HasType e ty }}</span></span></div></blockquote></div></small></div>typeCheck</span><span class="alectryon-token">]</span></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion">Goals accomplished<span class="bp">!</span> <span class="bp">🐙</span></div></blockquote></div></div></small></span><span class="alectryon-wsp"><span class="alectryon-token">
  </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="tc-lean-chk1d" style="display: none" type="checkbox"><label class="alectryon-input" for="tc-lean-chk1d"><span class="alectryon-token"><span class="bp">|</span> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>plus</var><b>: </b><span>Expr → Expr → Expr</span></span></div></blockquote></div></small></div>plus</span><span class="alectryon-token"> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>a</var><b>: </b><span>Expr</span></span></div></blockquote></div></small></div><span class="nv">a</span></span><span class="alectryon-token"> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>b</var><b>: </b><span>Expr</span></span></div></blockquote></div></small></div><span class="nv">b</span></span><span class="alectryon-token"> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>iha</var><b>: </b><span>typeCheck a = Maybe.unknown → ¬HasType a ty</span></span></div></blockquote></div></small></div><span class="nv">iha</span></span><span class="alectryon-token"> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>ihb</var><b>: </b><span>typeCheck b = Maybe.unknown → ¬HasType b ty</span></span></div></blockquote></div></small></div><span class="nv">ihb</span></span><span class="alectryon-token"> <span class="bp">=&gt;</span></span></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ty</var><span class="hyp-type"><b>: </b><span>Ty</span></span></span><br><span><var>a, b</var><span class="hyp-type"><b>: </b><span>Expr</span></span></span><br><span><var>iha</var><span class="hyp-type"><b>: </b><span>typeCheck a <span class="bp">=</span> Maybe.unknown <span class="bp">→</span> <span class="bp">¬</span>HasType a ty</span></span></span><br><span><var>ihb</var><span class="hyp-type"><b>: </b><span>typeCheck b <span class="bp">=</span> Maybe.unknown <span class="bp">→</span> <span class="bp">¬</span>HasType b ty</span></span></span><br></div><span class="goal-separator"><hr><span class="goal-name">plus</span></span><div class="goal-conclusion">(<span class="k">match</span> typeCheck a, typeCheck b <span class="k">with</span>
    <span class="bp">|</span> Maybe.found Ty.nat h₁, Maybe.found Ty.nat h₂ <span class="bp">=&gt;</span> Maybe.found Ty.nat (_ : HasType (plus a b) Ty.nat)
    <span class="bp">|</span> x, x_1 <span class="bp">=&gt;</span> Maybe.unknown) <span class="bp">=</span>
    Maybe.unknown <span class="bp">→</span>
  <span class="bp">¬</span>HasType (plus a b) ty</div></blockquote></div></div></small></span><span class="alectryon-wsp"><span class="alectryon-token">
    </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="tc-lean-chk1e" style="display: none" type="checkbox"><label class="alectryon-input" for="tc-lean-chk1e"><span class="alectryon-token"><span class="k">split</span></span></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ty</var><span class="hyp-type"><b>: </b><span>Ty</span></span></span><br><span><var>a, b</var><span class="hyp-type"><b>: </b><span>Expr</span></span></span><br><span><var>iha</var><span class="hyp-type"><b>: </b><span>typeCheck a <span class="bp">=</span> Maybe.unknown <span class="bp">→</span> <span class="bp">¬</span>HasType a ty</span></span></span><br><span><var>ihb</var><span class="hyp-type"><b>: </b><span>typeCheck b <span class="bp">=</span> Maybe.unknown <span class="bp">→</span> <span class="bp">¬</span>HasType b ty</span></span></span><br><span><var>x✝¹</var><span class="hyp-type"><b>: </b><span>{{ ty <span class="bp">|</span> HasType a ty }}</span></span></span><br><span><var>x✝</var><span class="hyp-type"><b>: </b><span>{{ ty <span class="bp">|</span> HasType b ty }}</span></span></span><br><span><var>h₁✝</var><span class="hyp-type"><b>: </b><span>HasType a Ty.nat</span></span></span><br><span><var>h₂✝</var><span class="hyp-type"><b>: </b><span>HasType b Ty.nat</span></span></span><br><span><var>heq✝¹</var><span class="hyp-type"><b>: </b><span>typeCheck a <span class="bp">=</span> Maybe.found Ty.nat h₁<span class="bp">✝</span></span></span></span><br><span><var>heq✝</var><span class="hyp-type"><b>: </b><span>typeCheck b <span class="bp">=</span> Maybe.found Ty.nat h₂<span class="bp">✝</span></span></span></span><br></div><span class="goal-separator"><hr><span class="goal-name">plus.h_1</span></span><div class="goal-conclusion">Maybe.found Ty.nat (_ : HasType (plus a b) Ty.nat) <span class="bp">=</span> Maybe.unknown <span class="bp">→</span> <span class="bp">¬</span>HasType (plus a b) ty</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="tc-lean-chk1f" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ty</var><span class="hyp-type"><b>: </b><span>Ty</span></span></span><br><span><var>a, b</var><span class="hyp-type"><b>: </b><span>Expr</span></span></span><br><span><var>iha</var><span class="hyp-type"><b>: </b><span>typeCheck a <span class="bp">=</span> Maybe.unknown <span class="bp">→</span> <span class="bp">¬</span>HasType a ty</span></span></span><br><span><var>ihb</var><span class="hyp-type"><b>: </b><span>typeCheck b <span class="bp">=</span> Maybe.unknown <span class="bp">→</span> <span class="bp">¬</span>HasType b ty</span></span></span><br><span><var>x✝²</var><span class="hyp-type"><b>: </b><span>{{ ty <span class="bp">|</span> HasType a ty }}</span></span></span><br><span><var>x✝¹</var><span class="hyp-type"><b>: </b><span>{{ ty <span class="bp">|</span> HasType b ty }}</span></span></span><br><span><var>x✝</var><span class="hyp-type"><b>: </b><span><span class="bp">∀</span> (h₁ : HasType a Ty.nat) (h₂ : HasType b Ty.nat),
  typeCheck a <span class="bp">=</span> Maybe.found Ty.nat h₁ <span class="bp">→</span> typeCheck b <span class="bp">=</span> Maybe.found Ty.nat h₂ <span class="bp">→</span> False</span></span></span><br></div><label class="goal-separator" for="tc-lean-chk1f"><hr><span class="goal-name">plus.h_2</span></label><div class="goal-conclusion">Maybe.unknown <span class="bp">=</span> Maybe.unknown <span class="bp">→</span> <span class="bp">¬</span>HasType (plus a b) ty</div></blockquote></div></div></div></small></span><span class="alectryon-wsp"><span class="alectryon-token">
    </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="tc-lean-chk20" style="display: none" type="checkbox"><label class="alectryon-input" for="tc-lean-chk20"><span class="alectryon-token"><span class="k">next</span></span><span class="alectryon-token"> <span class="bp">=&gt;</span></span></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ty</var><span class="hyp-type"><b>: </b><span>Ty</span></span></span><br><span><var>a, b</var><span class="hyp-type"><b>: </b><span>Expr</span></span></span><br><span><var>iha</var><span class="hyp-type"><b>: </b><span>typeCheck a <span class="bp">=</span> Maybe.unknown <span class="bp">→</span> <span class="bp">¬</span>HasType a ty</span></span></span><br><span><var>ihb</var><span class="hyp-type"><b>: </b><span>typeCheck b <span class="bp">=</span> Maybe.unknown <span class="bp">→</span> <span class="bp">¬</span>HasType b ty</span></span></span><br><span><var>x✝¹</var><span class="hyp-type"><b>: </b><span>{{ ty <span class="bp">|</span> HasType a ty }}</span></span></span><br><span><var>x✝</var><span class="hyp-type"><b>: </b><span>{{ ty <span class="bp">|</span> HasType b ty }}</span></span></span><br><span><var>h₁✝</var><span class="hyp-type"><b>: </b><span>HasType a Ty.nat</span></span></span><br><span><var>h₂✝</var><span class="hyp-type"><b>: </b><span>HasType b Ty.nat</span></span></span><br><span><var>heq✝¹</var><span class="hyp-type"><b>: </b><span>typeCheck a <span class="bp">=</span> Maybe.found Ty.nat h₁<span class="bp">✝</span></span></span></span><br><span><var>heq✝</var><span class="hyp-type"><b>: </b><span>typeCheck b <span class="bp">=</span> Maybe.found Ty.nat h₂<span class="bp">✝</span></span></span></span><br></div><span class="goal-separator"><hr><span class="goal-name">plus.h_1</span></span><div class="goal-conclusion">Maybe.found Ty.nat (_ : HasType (plus a b) Ty.nat) <span class="bp">=</span> Maybe.unknown <span class="bp">→</span> <span class="bp">¬</span>HasType (plus a b) ty</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="tc-lean-chk21" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ty</var><span class="hyp-type"><b>: </b><span>Ty</span></span></span><br><span><var>a, b</var><span class="hyp-type"><b>: </b><span>Expr</span></span></span><br><span><var>iha</var><span class="hyp-type"><b>: </b><span>typeCheck a <span class="bp">=</span> Maybe.unknown <span class="bp">→</span> <span class="bp">¬</span>HasType a ty</span></span></span><br><span><var>ihb</var><span class="hyp-type"><b>: </b><span>typeCheck b <span class="bp">=</span> Maybe.unknown <span class="bp">→</span> <span class="bp">¬</span>HasType b ty</span></span></span><br><span><var>x✝²</var><span class="hyp-type"><b>: </b><span>{{ ty <span class="bp">|</span> HasType a ty }}</span></span></span><br><span><var>x✝¹</var><span class="hyp-type"><b>: </b><span>{{ ty <span class="bp">|</span> HasType b ty }}</span></span></span><br><span><var>x✝</var><span class="hyp-type"><b>: </b><span><span class="bp">∀</span> (h₁ : HasType a Ty.nat) (h₂ : HasType b Ty.nat),
  typeCheck a <span class="bp">=</span> Maybe.found Ty.nat h₁ <span class="bp">→</span> typeCheck b <span class="bp">=</span> Maybe.found Ty.nat h₂ <span class="bp">→</span> False</span></span></span><br></div><label class="goal-separator" for="tc-lean-chk21"><hr><span class="goal-name">plus.h_2</span></label><div class="goal-conclusion">Maybe.unknown <span class="bp">=</span> Maybe.unknown <span class="bp">→</span> <span class="bp">¬</span>HasType (plus a b) ty</div></blockquote></div></div></div></small></span><span class="alectryon-wsp"><span class="alectryon-token"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="tc-lean-chk22" style="display: none" type="checkbox"><label class="alectryon-input" for="tc-lean-chk22"><span class="alectryon-token"><span class="k">intros</span></span></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ty</var><span class="hyp-type"><b>: </b><span>Ty</span></span></span><br><span><var>a, b</var><span class="hyp-type"><b>: </b><span>Expr</span></span></span><br><span><var>iha</var><span class="hyp-type"><b>: </b><span>typeCheck a <span class="bp">=</span> Maybe.unknown <span class="bp">→</span> <span class="bp">¬</span>HasType a ty</span></span></span><br><span><var>ihb</var><span class="hyp-type"><b>: </b><span>typeCheck b <span class="bp">=</span> Maybe.unknown <span class="bp">→</span> <span class="bp">¬</span>HasType b ty</span></span></span><br><span><var>x✝¹</var><span class="hyp-type"><b>: </b><span>{{ ty <span class="bp">|</span> HasType a ty }}</span></span></span><br><span><var>x✝</var><span class="hyp-type"><b>: </b><span>{{ ty <span class="bp">|</span> HasType b ty }}</span></span></span><br><span><var>h₁✝</var><span class="hyp-type"><b>: </b><span>HasType a Ty.nat</span></span></span><br><span><var>h₂✝</var><span class="hyp-type"><b>: </b><span>HasType b Ty.nat</span></span></span><br><span><var>heq✝¹</var><span class="hyp-type"><b>: </b><span>typeCheck a <span class="bp">=</span> Maybe.found Ty.nat h₁<span class="bp">✝</span></span></span></span><br><span><var>heq✝</var><span class="hyp-type"><b>: </b><span>typeCheck b <span class="bp">=</span> Maybe.found Ty.nat h₂<span class="bp">✝</span></span></span></span><br><span><var>a✝</var><span class="hyp-type"><b>: </b><span>Maybe.found Ty.nat (_ : HasType (plus a b) Ty.nat) <span class="bp">=</span> Maybe.unknown</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="bp">¬</span>HasType (plus a b) ty</div></blockquote></div></div></small></span><span class="alectryon-wsp"><span class="alectryon-token"><span class="bp">;</span></span><span class="alectryon-token"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="tc-lean-chk23" style="display: none" type="checkbox"><label class="alectryon-input" for="tc-lean-chk23"><span class="alectryon-token"><span class="k">contradiction</span></span></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion">Goals accomplished<span class="bp">!</span> <span class="bp">🐙</span></div></blockquote></div></div></small></span><span class="alectryon-wsp"><span class="alectryon-token">
    </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="tc-lean-chk24" style="display: none" type="checkbox"><label class="alectryon-input" for="tc-lean-chk24"><span class="alectryon-token"><span class="k">next</span></span><span class="alectryon-token"> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>ra</var><b>: </b><span>{{ ty | HasType a ty }}</span></span></div></blockquote></div></small></div><span class="nv">ra</span></span><span class="alectryon-token"> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>rb</var><b>: </b><span>{{ ty | HasType b ty }}</span></span></div></blockquote></div></small></div><span class="nv">rb</span></span><span class="alectryon-token"> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>hnp</var><b>: </b><span>∀ (h₁ : HasType a Ty.nat) (h₂ : HasType b Ty.nat),
  typeCheck a = Maybe.found Ty.nat h₁ → typeCheck b = Maybe.found Ty.nat h₂ → False</span></span></div></blockquote></div></small></div><span class="nv">hnp</span></span><span class="alectryon-token"> <span class="bp">=&gt;</span>
      <span class="c1">-- Recall that `hnp` is a hypothesis generated by the `split` tactic</span>
      <span class="c1">-- that asserts the previous case was not taken</span></span></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ty</var><span class="hyp-type"><b>: </b><span>Ty</span></span></span><br><span><var>a, b</var><span class="hyp-type"><b>: </b><span>Expr</span></span></span><br><span><var>iha</var><span class="hyp-type"><b>: </b><span>typeCheck a <span class="bp">=</span> Maybe.unknown <span class="bp">→</span> <span class="bp">¬</span>HasType a ty</span></span></span><br><span><var>ihb</var><span class="hyp-type"><b>: </b><span>typeCheck b <span class="bp">=</span> Maybe.unknown <span class="bp">→</span> <span class="bp">¬</span>HasType b ty</span></span></span><br><span><var>x✝²</var><span class="hyp-type"><b>: </b><span>{{ ty <span class="bp">|</span> HasType a ty }}</span></span></span><br><span><var>x✝¹</var><span class="hyp-type"><b>: </b><span>{{ ty <span class="bp">|</span> HasType b ty }}</span></span></span><br><span><var>x✝</var><span class="hyp-type"><b>: </b><span><span class="bp">∀</span> (h₁ : HasType a Ty.nat) (h₂ : HasType b Ty.nat),
  typeCheck a <span class="bp">=</span> Maybe.found Ty.nat h₁ <span class="bp">→</span> typeCheck b <span class="bp">=</span> Maybe.found Ty.nat h₂ <span class="bp">→</span> False</span></span></span><br></div><span class="goal-separator"><hr><span class="goal-name">plus.h_2</span></span><div class="goal-conclusion">Maybe.unknown <span class="bp">=</span> Maybe.unknown <span class="bp">→</span> <span class="bp">¬</span>HasType (plus a b) ty</div></blockquote></div></div></small></span><span class="alectryon-wsp"><span class="alectryon-token">
      </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="tc-lean-chk25" style="display: none" type="checkbox"><label class="alectryon-input" for="tc-lean-chk25"><span class="alectryon-token"><span class="k">intro</span></span><span class="alectryon-token"></span></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ty</var><span class="hyp-type"><b>: </b><span>Ty</span></span></span><br><span><var>a, b</var><span class="hyp-type"><b>: </b><span>Expr</span></span></span><br><span><var>iha</var><span class="hyp-type"><b>: </b><span>typeCheck a <span class="bp">=</span> Maybe.unknown <span class="bp">→</span> <span class="bp">¬</span>HasType a ty</span></span></span><br><span><var>ihb</var><span class="hyp-type"><b>: </b><span>typeCheck b <span class="bp">=</span> Maybe.unknown <span class="bp">→</span> <span class="bp">¬</span>HasType b ty</span></span></span><br><span><var>ra</var><span class="hyp-type"><b>: </b><span>{{ ty <span class="bp">|</span> HasType a ty }}</span></span></span><br><span><var>rb</var><span class="hyp-type"><b>: </b><span>{{ ty <span class="bp">|</span> HasType b ty }}</span></span></span><br><span><var>hnp</var><span class="hyp-type"><b>: </b><span><span class="bp">∀</span> (h₁ : HasType a Ty.nat) (h₂ : HasType b Ty.nat),
  typeCheck a <span class="bp">=</span> Maybe.found Ty.nat h₁ <span class="bp">→</span> typeCheck b <span class="bp">=</span> Maybe.found Ty.nat h₂ <span class="bp">→</span> False</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Maybe.unknown <span class="bp">=</span> Maybe.unknown <span class="bp">→</span> <span class="bp">¬</span>HasType (plus a b) ty</div></blockquote></div></div></small></span><span class="alectryon-wsp"><span class="alectryon-token"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="tc-lean-chk26" style="display: none" type="checkbox"><label class="alectryon-input" for="tc-lean-chk26"><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>h</var><b>: </b><span>Maybe.unknown = Maybe.unknown</span></span></div></blockquote></div></small></div><span class="nv">h</span></span></label><small class="alectryon-output"><div><div class="alectryon-messages"><blockquote class="alectryon-message">Warning: unused <span class="kd">variable</span> <span class="bp">`</span>h<span class="bp">`</span> [linter.unusedVariables]</blockquote></div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ty</var><span class="hyp-type"><b>: </b><span>Ty</span></span></span><br><span><var>a, b</var><span class="hyp-type"><b>: </b><span>Expr</span></span></span><br><span><var>iha</var><span class="hyp-type"><b>: </b><span>typeCheck a <span class="bp">=</span> Maybe.unknown <span class="bp">→</span> <span class="bp">¬</span>HasType a ty</span></span></span><br><span><var>ihb</var><span class="hyp-type"><b>: </b><span>typeCheck b <span class="bp">=</span> Maybe.unknown <span class="bp">→</span> <span class="bp">¬</span>HasType b ty</span></span></span><br><span><var>ra</var><span class="hyp-type"><b>: </b><span>{{ ty <span class="bp">|</span> HasType a ty }}</span></span></span><br><span><var>rb</var><span class="hyp-type"><b>: </b><span>{{ ty <span class="bp">|</span> HasType b ty }}</span></span></span><br><span><var>hnp</var><span class="hyp-type"><b>: </b><span><span class="bp">∀</span> (h₁ : HasType a Ty.nat) (h₂ : HasType b Ty.nat),
  typeCheck a <span class="bp">=</span> Maybe.found Ty.nat h₁ <span class="bp">→</span> typeCheck b <span class="bp">=</span> Maybe.found Ty.nat h₂ <span class="bp">→</span> False</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Maybe.unknown <span class="bp">=</span> Maybe.unknown <span class="bp">→</span> <span class="bp">¬</span>HasType (plus a b) ty</div></blockquote></div></div></small></span><span class="alectryon-wsp"><span class="alectryon-token"> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>ht</var><b>: </b><span>HasType (plus a b) ty</span></span></div></blockquote></div></small></div></span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="tc-lean-chk27" style="display: none" type="checkbox"><label class="alectryon-input" for="tc-lean-chk27"><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>ht</var><b>: </b><span>HasType (plus a b) ty</span></span></div></blockquote></div></small></div><span class="nv">ht</span></span></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ty</var><span class="hyp-type"><b>: </b><span>Ty</span></span></span><br><span><var>a, b</var><span class="hyp-type"><b>: </b><span>Expr</span></span></span><br><span><var>iha</var><span class="hyp-type"><b>: </b><span>typeCheck a <span class="bp">=</span> Maybe.unknown <span class="bp">→</span> <span class="bp">¬</span>HasType a ty</span></span></span><br><span><var>ihb</var><span class="hyp-type"><b>: </b><span>typeCheck b <span class="bp">=</span> Maybe.unknown <span class="bp">→</span> <span class="bp">¬</span>HasType b ty</span></span></span><br><span><var>ra</var><span class="hyp-type"><b>: </b><span>{{ ty <span class="bp">|</span> HasType a ty }}</span></span></span><br><span><var>rb</var><span class="hyp-type"><b>: </b><span>{{ ty <span class="bp">|</span> HasType b ty }}</span></span></span><br><span><var>hnp</var><span class="hyp-type"><b>: </b><span><span class="bp">∀</span> (h₁ : HasType a Ty.nat) (h₂ : HasType b Ty.nat),
  typeCheck a <span class="bp">=</span> Maybe.found Ty.nat h₁ <span class="bp">→</span> typeCheck b <span class="bp">=</span> Maybe.found Ty.nat h₂ <span class="bp">→</span> False</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>Maybe.unknown <span class="bp">=</span> Maybe.unknown</span></span></span><br><span><var>ht</var><span class="hyp-type"><b>: </b><span>HasType (plus a b) ty</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">False</div></blockquote></div></div></small></span><span class="alectryon-wsp"><span class="alectryon-token">
      </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="tc-lean-chk28" style="display: none" type="checkbox"><label class="alectryon-input" for="tc-lean-chk28"><span class="alectryon-token"><span class="k">cases</span></span><span class="alectryon-token"> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>ht</var><b>: </b><span>HasType (plus a b) ty</span></span></div></blockquote></div></small></div><span class="nv">ht</span></span><span class="alectryon-token"> </span><span class="alectryon-token"><span class="k">with</span></span><span class="alectryon-token"></span></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ty</var><span class="hyp-type"><b>: </b><span>Ty</span></span></span><br><span><var>a, b</var><span class="hyp-type"><b>: </b><span>Expr</span></span></span><br><span><var>iha</var><span class="hyp-type"><b>: </b><span>typeCheck a <span class="bp">=</span> Maybe.unknown <span class="bp">→</span> <span class="bp">¬</span>HasType a ty</span></span></span><br><span><var>ihb</var><span class="hyp-type"><b>: </b><span>typeCheck b <span class="bp">=</span> Maybe.unknown <span class="bp">→</span> <span class="bp">¬</span>HasType b ty</span></span></span><br><span><var>ra</var><span class="hyp-type"><b>: </b><span>{{ ty <span class="bp">|</span> HasType a ty }}</span></span></span><br><span><var>rb</var><span class="hyp-type"><b>: </b><span>{{ ty <span class="bp">|</span> HasType b ty }}</span></span></span><br><span><var>hnp</var><span class="hyp-type"><b>: </b><span><span class="bp">∀</span> (h₁ : HasType a Ty.nat) (h₂ : HasType b Ty.nat),
  typeCheck a <span class="bp">=</span> Maybe.found Ty.nat h₁ <span class="bp">→</span> typeCheck b <span class="bp">=</span> Maybe.found Ty.nat h₂ <span class="bp">→</span> False</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>Maybe.unknown <span class="bp">=</span> Maybe.unknown</span></span></span><br><span><var>ht</var><span class="hyp-type"><b>: </b><span>HasType (plus a b) ty</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">False</div></blockquote></div></div></small></span><span class="alectryon-wsp"><span class="alectryon-token">
      </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="tc-lean-chk29" style="display: none" type="checkbox"><label class="alectryon-input" for="tc-lean-chk29"><span class="alectryon-token"><span class="bp">|</span> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>plus</var><b>: </b><span>∀ {a b : Expr}, HasType a Ty.nat → HasType b Ty.nat → HasType (plus a b) Ty.nat</span></span></div></blockquote></div></small></div>plus</span><span class="alectryon-token"> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>h₁</var><b>: </b><span>HasType a✝ Ty.nat</span></span></div></blockquote></div></small></div><span class="nv">h₁</span></span><span class="alectryon-token"> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>h₂</var><b>: </b><span>HasType b✝ Ty.nat</span></span></div></blockquote></div></small></div><span class="nv">h₂</span></span><span class="alectryon-token"> <span class="bp">=&gt;</span></span></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a, b</var><span class="hyp-type"><b>: </b><span>Expr</span></span></span><br><span><var>ra</var><span class="hyp-type"><b>: </b><span>{{ ty <span class="bp">|</span> HasType a ty }}</span></span></span><br><span><var>rb</var><span class="hyp-type"><b>: </b><span>{{ ty <span class="bp">|</span> HasType b ty }}</span></span></span><br><span><var>hnp</var><span class="hyp-type"><b>: </b><span><span class="bp">∀</span> (h₁ : HasType a Ty.nat) (h₂ : HasType b Ty.nat),
  typeCheck a <span class="bp">=</span> Maybe.found Ty.nat h₁ <span class="bp">→</span> typeCheck b <span class="bp">=</span> Maybe.found Ty.nat h₂ <span class="bp">→</span> False</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>Maybe.unknown <span class="bp">=</span> Maybe.unknown</span></span></span><br><span><var>h₁</var><span class="hyp-type"><b>: </b><span>HasType a Ty.nat</span></span></span><br><span><var>h₂</var><span class="hyp-type"><b>: </b><span>HasType b Ty.nat</span></span></span><br><span><var>iha</var><span class="hyp-type"><b>: </b><span>typeCheck a <span class="bp">=</span> Maybe.unknown <span class="bp">→</span> <span class="bp">¬</span>HasType a Ty.nat</span></span></span><br><span><var>ihb</var><span class="hyp-type"><b>: </b><span>typeCheck b <span class="bp">=</span> Maybe.unknown <span class="bp">→</span> <span class="bp">¬</span>HasType b Ty.nat</span></span></span><br></div><span class="goal-separator"><hr><span class="goal-name">plus</span></span><div class="goal-conclusion">False</div></blockquote></div></div></small></span><span class="alectryon-wsp"><span class="alectryon-token"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="tc-lean-chk2a" style="display: none" type="checkbox"><label class="alectryon-input" for="tc-lean-chk2a"><span class="alectryon-token"><span class="k">exact</span></span><span class="alectryon-token"> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>hnp</var><b>: </b><span>∀ (h₁ : HasType a Ty.nat) (h₂ : HasType b Ty.nat),
  typeCheck a = Maybe.found Ty.nat h₁ → typeCheck b = Maybe.found Ty.nat h₂ → False</span></span></div></blockquote></div></small></div><span class="nv">hnp</span></span><span class="alectryon-token"> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>h₁</var><b>: </b><span>HasType a Ty.nat</span></span></div></blockquote></div></small></div><span class="nv">h₁</span></span><span class="alectryon-token"> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>h₂</var><b>: </b><span>HasType b Ty.nat</span></span></div></blockquote></div></small></div><span class="nv">h₂</span></span><span class="alectryon-token"> (</span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>typeCheck_correct</var><b>: </b><span>∀ {e : Expr} {ty : Ty} {h : HasType e ty}, HasType e ty → typeCheck e ≠ Maybe.unknown → typeCheck e = Maybe.found ty h</span></span></div></blockquote></div></small></div>typeCheck_correct</span><span class="alectryon-token"> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>h₁</var><b>: </b><span>HasType a Ty.nat</span></span></div></blockquote></div></small></div><span class="nv">h₁</span></span><span class="alectryon-token"> (</span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>iha</var><b>: </b><span>typeCheck a = Maybe.unknown → ¬HasType a Ty.nat</span></span></div></blockquote></div></small></div><span class="nv">iha</span></span><span class="alectryon-token"> <span class="bp">·</span> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>h₁</var><b>: </b><span>HasType a Ty.nat</span></span></div></blockquote></div></small></div><span class="nv">h₁</span></span><span class="alectryon-token">)) (</span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>typeCheck_correct</var><b>: </b><span>∀ {e : Expr} {ty : Ty} {h : HasType e ty}, HasType e ty → typeCheck e ≠ Maybe.unknown → typeCheck e = Maybe.found ty h</span></span></div></blockquote></div></small></div>typeCheck_correct</span><span class="alectryon-token"> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>h₂</var><b>: </b><span>HasType b Ty.nat</span></span></div></blockquote></div></small></div><span class="nv">h₂</span></span><span class="alectryon-token"> (</span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>ihb</var><b>: </b><span>typeCheck b = Maybe.unknown → ¬HasType b Ty.nat</span></span></div></blockquote></div></small></div><span class="nv">ihb</span></span><span class="alectryon-token"> <span class="bp">·</span> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>h₂</var><b>: </b><span>HasType b Ty.nat</span></span></div></blockquote></div></small></div><span class="nv">h₂</span></span><span class="alectryon-token">))</span></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion">Goals accomplished<span class="bp">!</span> <span class="bp">🐙</span></div></blockquote></div></div></small></span><span class="alectryon-wsp"><span class="alectryon-token">
  </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="tc-lean-chk2b" style="display: none" type="checkbox"><label class="alectryon-input" for="tc-lean-chk2b"><span class="alectryon-token"><span class="bp">|</span> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>and</var><b>: </b><span>Expr → Expr → Expr</span></span></div></blockquote></div></small></div>and</span><span class="alectryon-token"> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>a</var><b>: </b><span>Expr</span></span></div></blockquote></div></small></div><span class="nv">a</span></span><span class="alectryon-token"> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>b</var><b>: </b><span>Expr</span></span></div></blockquote></div></small></div><span class="nv">b</span></span><span class="alectryon-token"> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>iha</var><b>: </b><span>typeCheck a = Maybe.unknown → ¬HasType a ty</span></span></div></blockquote></div></small></div><span class="nv">iha</span></span><span class="alectryon-token"> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>ihb</var><b>: </b><span>typeCheck b = Maybe.unknown → ¬HasType b ty</span></span></div></blockquote></div></small></div><span class="nv">ihb</span></span><span class="alectryon-token"> <span class="bp">=&gt;</span></span></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ty</var><span class="hyp-type"><b>: </b><span>Ty</span></span></span><br><span><var>a, b</var><span class="hyp-type"><b>: </b><span>Expr</span></span></span><br><span><var>iha</var><span class="hyp-type"><b>: </b><span>typeCheck a <span class="bp">=</span> Maybe.unknown <span class="bp">→</span> <span class="bp">¬</span>HasType a ty</span></span></span><br><span><var>ihb</var><span class="hyp-type"><b>: </b><span>typeCheck b <span class="bp">=</span> Maybe.unknown <span class="bp">→</span> <span class="bp">¬</span>HasType b ty</span></span></span><br></div><span class="goal-separator"><hr><span class="goal-name">and</span></span><div class="goal-conclusion">(<span class="k">match</span> typeCheck a, typeCheck b <span class="k">with</span>
    <span class="bp">|</span> Maybe.found Ty.bool h₁, Maybe.found Ty.bool h₂ <span class="bp">=&gt;</span> Maybe.found Ty.bool (_ : HasType (and a b) Ty.bool)
    <span class="bp">|</span> x, x_1 <span class="bp">=&gt;</span> Maybe.unknown) <span class="bp">=</span>
    Maybe.unknown <span class="bp">→</span>
  <span class="bp">¬</span>HasType (and a b) ty</div></blockquote></div></div></small></span><span class="alectryon-wsp"><span class="alectryon-token">
    </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="tc-lean-chk2c" style="display: none" type="checkbox"><label class="alectryon-input" for="tc-lean-chk2c"><span class="alectryon-token"><span class="k">split</span></span></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ty</var><span class="hyp-type"><b>: </b><span>Ty</span></span></span><br><span><var>a, b</var><span class="hyp-type"><b>: </b><span>Expr</span></span></span><br><span><var>iha</var><span class="hyp-type"><b>: </b><span>typeCheck a <span class="bp">=</span> Maybe.unknown <span class="bp">→</span> <span class="bp">¬</span>HasType a ty</span></span></span><br><span><var>ihb</var><span class="hyp-type"><b>: </b><span>typeCheck b <span class="bp">=</span> Maybe.unknown <span class="bp">→</span> <span class="bp">¬</span>HasType b ty</span></span></span><br><span><var>x✝¹</var><span class="hyp-type"><b>: </b><span>{{ ty <span class="bp">|</span> HasType a ty }}</span></span></span><br><span><var>x✝</var><span class="hyp-type"><b>: </b><span>{{ ty <span class="bp">|</span> HasType b ty }}</span></span></span><br><span><var>h₁✝</var><span class="hyp-type"><b>: </b><span>HasType a Ty.bool</span></span></span><br><span><var>h₂✝</var><span class="hyp-type"><b>: </b><span>HasType b Ty.bool</span></span></span><br><span><var>heq✝¹</var><span class="hyp-type"><b>: </b><span>typeCheck a <span class="bp">=</span> Maybe.found Ty.bool h₁<span class="bp">✝</span></span></span></span><br><span><var>heq✝</var><span class="hyp-type"><b>: </b><span>typeCheck b <span class="bp">=</span> Maybe.found Ty.bool h₂<span class="bp">✝</span></span></span></span><br></div><span class="goal-separator"><hr><span class="goal-name">and.h_1</span></span><div class="goal-conclusion">Maybe.found Ty.bool (_ : HasType (and a b) Ty.bool) <span class="bp">=</span> Maybe.unknown <span class="bp">→</span> <span class="bp">¬</span>HasType (and a b) ty</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="tc-lean-chk2d" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ty</var><span class="hyp-type"><b>: </b><span>Ty</span></span></span><br><span><var>a, b</var><span class="hyp-type"><b>: </b><span>Expr</span></span></span><br><span><var>iha</var><span class="hyp-type"><b>: </b><span>typeCheck a <span class="bp">=</span> Maybe.unknown <span class="bp">→</span> <span class="bp">¬</span>HasType a ty</span></span></span><br><span><var>ihb</var><span class="hyp-type"><b>: </b><span>typeCheck b <span class="bp">=</span> Maybe.unknown <span class="bp">→</span> <span class="bp">¬</span>HasType b ty</span></span></span><br><span><var>x✝²</var><span class="hyp-type"><b>: </b><span>{{ ty <span class="bp">|</span> HasType a ty }}</span></span></span><br><span><var>x✝¹</var><span class="hyp-type"><b>: </b><span>{{ ty <span class="bp">|</span> HasType b ty }}</span></span></span><br><span><var>x✝</var><span class="hyp-type"><b>: </b><span><span class="bp">∀</span> (h₁ : HasType a Ty.bool) (h₂ : HasType b Ty.bool),
  typeCheck a <span class="bp">=</span> Maybe.found Ty.bool h₁ <span class="bp">→</span> typeCheck b <span class="bp">=</span> Maybe.found Ty.bool h₂ <span class="bp">→</span> False</span></span></span><br></div><label class="goal-separator" for="tc-lean-chk2d"><hr><span class="goal-name">and.h_2</span></label><div class="goal-conclusion">Maybe.unknown <span class="bp">=</span> Maybe.unknown <span class="bp">→</span> <span class="bp">¬</span>HasType (and a b) ty</div></blockquote></div></div></div></small></span><span class="alectryon-wsp"><span class="alectryon-token">
    </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="tc-lean-chk2e" style="display: none" type="checkbox"><label class="alectryon-input" for="tc-lean-chk2e"><span class="alectryon-token"><span class="k">next</span></span><span class="alectryon-token"> <span class="bp">=&gt;</span></span></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ty</var><span class="hyp-type"><b>: </b><span>Ty</span></span></span><br><span><var>a, b</var><span class="hyp-type"><b>: </b><span>Expr</span></span></span><br><span><var>iha</var><span class="hyp-type"><b>: </b><span>typeCheck a <span class="bp">=</span> Maybe.unknown <span class="bp">→</span> <span class="bp">¬</span>HasType a ty</span></span></span><br><span><var>ihb</var><span class="hyp-type"><b>: </b><span>typeCheck b <span class="bp">=</span> Maybe.unknown <span class="bp">→</span> <span class="bp">¬</span>HasType b ty</span></span></span><br><span><var>x✝¹</var><span class="hyp-type"><b>: </b><span>{{ ty <span class="bp">|</span> HasType a ty }}</span></span></span><br><span><var>x✝</var><span class="hyp-type"><b>: </b><span>{{ ty <span class="bp">|</span> HasType b ty }}</span></span></span><br><span><var>h₁✝</var><span class="hyp-type"><b>: </b><span>HasType a Ty.bool</span></span></span><br><span><var>h₂✝</var><span class="hyp-type"><b>: </b><span>HasType b Ty.bool</span></span></span><br><span><var>heq✝¹</var><span class="hyp-type"><b>: </b><span>typeCheck a <span class="bp">=</span> Maybe.found Ty.bool h₁<span class="bp">✝</span></span></span></span><br><span><var>heq✝</var><span class="hyp-type"><b>: </b><span>typeCheck b <span class="bp">=</span> Maybe.found Ty.bool h₂<span class="bp">✝</span></span></span></span><br></div><span class="goal-separator"><hr><span class="goal-name">and.h_1</span></span><div class="goal-conclusion">Maybe.found Ty.bool (_ : HasType (and a b) Ty.bool) <span class="bp">=</span> Maybe.unknown <span class="bp">→</span> <span class="bp">¬</span>HasType (and a b) ty</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="tc-lean-chk2f" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ty</var><span class="hyp-type"><b>: </b><span>Ty</span></span></span><br><span><var>a, b</var><span class="hyp-type"><b>: </b><span>Expr</span></span></span><br><span><var>iha</var><span class="hyp-type"><b>: </b><span>typeCheck a <span class="bp">=</span> Maybe.unknown <span class="bp">→</span> <span class="bp">¬</span>HasType a ty</span></span></span><br><span><var>ihb</var><span class="hyp-type"><b>: </b><span>typeCheck b <span class="bp">=</span> Maybe.unknown <span class="bp">→</span> <span class="bp">¬</span>HasType b ty</span></span></span><br><span><var>x✝²</var><span class="hyp-type"><b>: </b><span>{{ ty <span class="bp">|</span> HasType a ty }}</span></span></span><br><span><var>x✝¹</var><span class="hyp-type"><b>: </b><span>{{ ty <span class="bp">|</span> HasType b ty }}</span></span></span><br><span><var>x✝</var><span class="hyp-type"><b>: </b><span><span class="bp">∀</span> (h₁ : HasType a Ty.bool) (h₂ : HasType b Ty.bool),
  typeCheck a <span class="bp">=</span> Maybe.found Ty.bool h₁ <span class="bp">→</span> typeCheck b <span class="bp">=</span> Maybe.found Ty.bool h₂ <span class="bp">→</span> False</span></span></span><br></div><label class="goal-separator" for="tc-lean-chk2f"><hr><span class="goal-name">and.h_2</span></label><div class="goal-conclusion">Maybe.unknown <span class="bp">=</span> Maybe.unknown <span class="bp">→</span> <span class="bp">¬</span>HasType (and a b) ty</div></blockquote></div></div></div></small></span><span class="alectryon-wsp"><span class="alectryon-token"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="tc-lean-chk30" style="display: none" type="checkbox"><label class="alectryon-input" for="tc-lean-chk30"><span class="alectryon-token"><span class="k">intros</span></span></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ty</var><span class="hyp-type"><b>: </b><span>Ty</span></span></span><br><span><var>a, b</var><span class="hyp-type"><b>: </b><span>Expr</span></span></span><br><span><var>iha</var><span class="hyp-type"><b>: </b><span>typeCheck a <span class="bp">=</span> Maybe.unknown <span class="bp">→</span> <span class="bp">¬</span>HasType a ty</span></span></span><br><span><var>ihb</var><span class="hyp-type"><b>: </b><span>typeCheck b <span class="bp">=</span> Maybe.unknown <span class="bp">→</span> <span class="bp">¬</span>HasType b ty</span></span></span><br><span><var>x✝¹</var><span class="hyp-type"><b>: </b><span>{{ ty <span class="bp">|</span> HasType a ty }}</span></span></span><br><span><var>x✝</var><span class="hyp-type"><b>: </b><span>{{ ty <span class="bp">|</span> HasType b ty }}</span></span></span><br><span><var>h₁✝</var><span class="hyp-type"><b>: </b><span>HasType a Ty.bool</span></span></span><br><span><var>h₂✝</var><span class="hyp-type"><b>: </b><span>HasType b Ty.bool</span></span></span><br><span><var>heq✝¹</var><span class="hyp-type"><b>: </b><span>typeCheck a <span class="bp">=</span> Maybe.found Ty.bool h₁<span class="bp">✝</span></span></span></span><br><span><var>heq✝</var><span class="hyp-type"><b>: </b><span>typeCheck b <span class="bp">=</span> Maybe.found Ty.bool h₂<span class="bp">✝</span></span></span></span><br><span><var>a✝</var><span class="hyp-type"><b>: </b><span>Maybe.found Ty.bool (_ : HasType (and a b) Ty.bool) <span class="bp">=</span> Maybe.unknown</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="bp">¬</span>HasType (and a b) ty</div></blockquote></div></div></small></span><span class="alectryon-wsp"><span class="alectryon-token"><span class="bp">;</span></span><span class="alectryon-token"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="tc-lean-chk31" style="display: none" type="checkbox"><label class="alectryon-input" for="tc-lean-chk31"><span class="alectryon-token"><span class="k">contradiction</span></span></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion">Goals accomplished<span class="bp">!</span> <span class="bp">🐙</span></div></blockquote></div></div></small></span><span class="alectryon-wsp"><span class="alectryon-token">
    </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="tc-lean-chk32" style="display: none" type="checkbox"><label class="alectryon-input" for="tc-lean-chk32"><span class="alectryon-token"><span class="k">next</span></span><span class="alectryon-token"> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>ra</var><b>: </b><span>{{ ty | HasType a ty }}</span></span></div></blockquote></div></small></div><span class="nv">ra</span></span><span class="alectryon-token"> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>rb</var><b>: </b><span>{{ ty | HasType b ty }}</span></span></div></blockquote></div></small></div><span class="nv">rb</span></span><span class="alectryon-token"> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>hnp</var><b>: </b><span>∀ (h₁ : HasType a Ty.bool) (h₂ : HasType b Ty.bool),
  typeCheck a = Maybe.found Ty.bool h₁ → typeCheck b = Maybe.found Ty.bool h₂ → False</span></span></div></blockquote></div></small></div><span class="nv">hnp</span></span><span class="alectryon-token"> <span class="bp">=&gt;</span></span></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ty</var><span class="hyp-type"><b>: </b><span>Ty</span></span></span><br><span><var>a, b</var><span class="hyp-type"><b>: </b><span>Expr</span></span></span><br><span><var>iha</var><span class="hyp-type"><b>: </b><span>typeCheck a <span class="bp">=</span> Maybe.unknown <span class="bp">→</span> <span class="bp">¬</span>HasType a ty</span></span></span><br><span><var>ihb</var><span class="hyp-type"><b>: </b><span>typeCheck b <span class="bp">=</span> Maybe.unknown <span class="bp">→</span> <span class="bp">¬</span>HasType b ty</span></span></span><br><span><var>x✝²</var><span class="hyp-type"><b>: </b><span>{{ ty <span class="bp">|</span> HasType a ty }}</span></span></span><br><span><var>x✝¹</var><span class="hyp-type"><b>: </b><span>{{ ty <span class="bp">|</span> HasType b ty }}</span></span></span><br><span><var>x✝</var><span class="hyp-type"><b>: </b><span><span class="bp">∀</span> (h₁ : HasType a Ty.bool) (h₂ : HasType b Ty.bool),
  typeCheck a <span class="bp">=</span> Maybe.found Ty.bool h₁ <span class="bp">→</span> typeCheck b <span class="bp">=</span> Maybe.found Ty.bool h₂ <span class="bp">→</span> False</span></span></span><br></div><span class="goal-separator"><hr><span class="goal-name">and.h_2</span></span><div class="goal-conclusion">Maybe.unknown <span class="bp">=</span> Maybe.unknown <span class="bp">→</span> <span class="bp">¬</span>HasType (and a b) ty</div></blockquote></div></div></small></span><span class="alectryon-wsp"><span class="alectryon-token">
      </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="tc-lean-chk33" style="display: none" type="checkbox"><label class="alectryon-input" for="tc-lean-chk33"><span class="alectryon-token"><span class="k">intro</span></span><span class="alectryon-token"></span></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ty</var><span class="hyp-type"><b>: </b><span>Ty</span></span></span><br><span><var>a, b</var><span class="hyp-type"><b>: </b><span>Expr</span></span></span><br><span><var>iha</var><span class="hyp-type"><b>: </b><span>typeCheck a <span class="bp">=</span> Maybe.unknown <span class="bp">→</span> <span class="bp">¬</span>HasType a ty</span></span></span><br><span><var>ihb</var><span class="hyp-type"><b>: </b><span>typeCheck b <span class="bp">=</span> Maybe.unknown <span class="bp">→</span> <span class="bp">¬</span>HasType b ty</span></span></span><br><span><var>ra</var><span class="hyp-type"><b>: </b><span>{{ ty <span class="bp">|</span> HasType a ty }}</span></span></span><br><span><var>rb</var><span class="hyp-type"><b>: </b><span>{{ ty <span class="bp">|</span> HasType b ty }}</span></span></span><br><span><var>hnp</var><span class="hyp-type"><b>: </b><span><span class="bp">∀</span> (h₁ : HasType a Ty.bool) (h₂ : HasType b Ty.bool),
  typeCheck a <span class="bp">=</span> Maybe.found Ty.bool h₁ <span class="bp">→</span> typeCheck b <span class="bp">=</span> Maybe.found Ty.bool h₂ <span class="bp">→</span> False</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Maybe.unknown <span class="bp">=</span> Maybe.unknown <span class="bp">→</span> <span class="bp">¬</span>HasType (and a b) ty</div></blockquote></div></div></small></span><span class="alectryon-wsp"><span class="alectryon-token"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="tc-lean-chk34" style="display: none" type="checkbox"><label class="alectryon-input" for="tc-lean-chk34"><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>h</var><b>: </b><span>Maybe.unknown = Maybe.unknown</span></span></div></blockquote></div></small></div><span class="nv">h</span></span></label><small class="alectryon-output"><div><div class="alectryon-messages"><blockquote class="alectryon-message">Warning: unused <span class="kd">variable</span> <span class="bp">`</span>h<span class="bp">`</span> [linter.unusedVariables]</blockquote></div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ty</var><span class="hyp-type"><b>: </b><span>Ty</span></span></span><br><span><var>a, b</var><span class="hyp-type"><b>: </b><span>Expr</span></span></span><br><span><var>iha</var><span class="hyp-type"><b>: </b><span>typeCheck a <span class="bp">=</span> Maybe.unknown <span class="bp">→</span> <span class="bp">¬</span>HasType a ty</span></span></span><br><span><var>ihb</var><span class="hyp-type"><b>: </b><span>typeCheck b <span class="bp">=</span> Maybe.unknown <span class="bp">→</span> <span class="bp">¬</span>HasType b ty</span></span></span><br><span><var>ra</var><span class="hyp-type"><b>: </b><span>{{ ty <span class="bp">|</span> HasType a ty }}</span></span></span><br><span><var>rb</var><span class="hyp-type"><b>: </b><span>{{ ty <span class="bp">|</span> HasType b ty }}</span></span></span><br><span><var>hnp</var><span class="hyp-type"><b>: </b><span><span class="bp">∀</span> (h₁ : HasType a Ty.bool) (h₂ : HasType b Ty.bool),
  typeCheck a <span class="bp">=</span> Maybe.found Ty.bool h₁ <span class="bp">→</span> typeCheck b <span class="bp">=</span> Maybe.found Ty.bool h₂ <span class="bp">→</span> False</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Maybe.unknown <span class="bp">=</span> Maybe.unknown <span class="bp">→</span> <span class="bp">¬</span>HasType (and a b) ty</div></blockquote></div></div></small></span><span class="alectryon-wsp"><span class="alectryon-token"> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>ht</var><b>: </b><span>HasType (and a b) ty</span></span></div></blockquote></div></small></div></span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="tc-lean-chk35" style="display: none" type="checkbox"><label class="alectryon-input" for="tc-lean-chk35"><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>ht</var><b>: </b><span>HasType (and a b) ty</span></span></div></blockquote></div></small></div><span class="nv">ht</span></span></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ty</var><span class="hyp-type"><b>: </b><span>Ty</span></span></span><br><span><var>a, b</var><span class="hyp-type"><b>: </b><span>Expr</span></span></span><br><span><var>iha</var><span class="hyp-type"><b>: </b><span>typeCheck a <span class="bp">=</span> Maybe.unknown <span class="bp">→</span> <span class="bp">¬</span>HasType a ty</span></span></span><br><span><var>ihb</var><span class="hyp-type"><b>: </b><span>typeCheck b <span class="bp">=</span> Maybe.unknown <span class="bp">→</span> <span class="bp">¬</span>HasType b ty</span></span></span><br><span><var>ra</var><span class="hyp-type"><b>: </b><span>{{ ty <span class="bp">|</span> HasType a ty }}</span></span></span><br><span><var>rb</var><span class="hyp-type"><b>: </b><span>{{ ty <span class="bp">|</span> HasType b ty }}</span></span></span><br><span><var>hnp</var><span class="hyp-type"><b>: </b><span><span class="bp">∀</span> (h₁ : HasType a Ty.bool) (h₂ : HasType b Ty.bool),
  typeCheck a <span class="bp">=</span> Maybe.found Ty.bool h₁ <span class="bp">→</span> typeCheck b <span class="bp">=</span> Maybe.found Ty.bool h₂ <span class="bp">→</span> False</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>Maybe.unknown <span class="bp">=</span> Maybe.unknown</span></span></span><br><span><var>ht</var><span class="hyp-type"><b>: </b><span>HasType (and a b) ty</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">False</div></blockquote></div></div></small></span><span class="alectryon-wsp"><span class="alectryon-token">
      </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="tc-lean-chk36" style="display: none" type="checkbox"><label class="alectryon-input" for="tc-lean-chk36"><span class="alectryon-token"><span class="k">cases</span></span><span class="alectryon-token"> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>ht</var><b>: </b><span>HasType (and a b) ty</span></span></div></blockquote></div></small></div><span class="nv">ht</span></span><span class="alectryon-token"> </span><span class="alectryon-token"><span class="k">with</span></span><span class="alectryon-token"></span></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ty</var><span class="hyp-type"><b>: </b><span>Ty</span></span></span><br><span><var>a, b</var><span class="hyp-type"><b>: </b><span>Expr</span></span></span><br><span><var>iha</var><span class="hyp-type"><b>: </b><span>typeCheck a <span class="bp">=</span> Maybe.unknown <span class="bp">→</span> <span class="bp">¬</span>HasType a ty</span></span></span><br><span><var>ihb</var><span class="hyp-type"><b>: </b><span>typeCheck b <span class="bp">=</span> Maybe.unknown <span class="bp">→</span> <span class="bp">¬</span>HasType b ty</span></span></span><br><span><var>ra</var><span class="hyp-type"><b>: </b><span>{{ ty <span class="bp">|</span> HasType a ty }}</span></span></span><br><span><var>rb</var><span class="hyp-type"><b>: </b><span>{{ ty <span class="bp">|</span> HasType b ty }}</span></span></span><br><span><var>hnp</var><span class="hyp-type"><b>: </b><span><span class="bp">∀</span> (h₁ : HasType a Ty.bool) (h₂ : HasType b Ty.bool),
  typeCheck a <span class="bp">=</span> Maybe.found Ty.bool h₁ <span class="bp">→</span> typeCheck b <span class="bp">=</span> Maybe.found Ty.bool h₂ <span class="bp">→</span> False</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>Maybe.unknown <span class="bp">=</span> Maybe.unknown</span></span></span><br><span><var>ht</var><span class="hyp-type"><b>: </b><span>HasType (and a b) ty</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">False</div></blockquote></div></div></small></span><span class="alectryon-wsp"><span class="alectryon-token">
      </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="tc-lean-chk37" style="display: none" type="checkbox"><label class="alectryon-input" for="tc-lean-chk37"><span class="alectryon-token"><span class="bp">|</span> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>and</var><b>: </b><span>∀ {a b : Expr}, HasType a Ty.bool → HasType b Ty.bool → HasType (and a b) Ty.bool</span></span></div></blockquote></div></small></div>and</span><span class="alectryon-token"> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>h₁</var><b>: </b><span>HasType a✝ Ty.bool</span></span></div></blockquote></div></small></div><span class="nv">h₁</span></span><span class="alectryon-token"> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>h₂</var><b>: </b><span>HasType b✝ Ty.bool</span></span></div></blockquote></div></small></div><span class="nv">h₂</span></span><span class="alectryon-token"> <span class="bp">=&gt;</span></span></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a, b</var><span class="hyp-type"><b>: </b><span>Expr</span></span></span><br><span><var>ra</var><span class="hyp-type"><b>: </b><span>{{ ty <span class="bp">|</span> HasType a ty }}</span></span></span><br><span><var>rb</var><span class="hyp-type"><b>: </b><span>{{ ty <span class="bp">|</span> HasType b ty }}</span></span></span><br><span><var>hnp</var><span class="hyp-type"><b>: </b><span><span class="bp">∀</span> (h₁ : HasType a Ty.bool) (h₂ : HasType b Ty.bool),
  typeCheck a <span class="bp">=</span> Maybe.found Ty.bool h₁ <span class="bp">→</span> typeCheck b <span class="bp">=</span> Maybe.found Ty.bool h₂ <span class="bp">→</span> False</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>Maybe.unknown <span class="bp">=</span> Maybe.unknown</span></span></span><br><span><var>h₁</var><span class="hyp-type"><b>: </b><span>HasType a Ty.bool</span></span></span><br><span><var>h₂</var><span class="hyp-type"><b>: </b><span>HasType b Ty.bool</span></span></span><br><span><var>iha</var><span class="hyp-type"><b>: </b><span>typeCheck a <span class="bp">=</span> Maybe.unknown <span class="bp">→</span> <span class="bp">¬</span>HasType a Ty.bool</span></span></span><br><span><var>ihb</var><span class="hyp-type"><b>: </b><span>typeCheck b <span class="bp">=</span> Maybe.unknown <span class="bp">→</span> <span class="bp">¬</span>HasType b Ty.bool</span></span></span><br></div><span class="goal-separator"><hr><span class="goal-name">and</span></span><div class="goal-conclusion">False</div></blockquote></div></div></small></span><span class="alectryon-wsp"><span class="alectryon-token">  </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="tc-lean-chk38" style="display: none" type="checkbox"><label class="alectryon-input" for="tc-lean-chk38"><span class="alectryon-token"><span class="k">exact</span></span><span class="alectryon-token"> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>hnp</var><b>: </b><span>∀ (h₁ : HasType a Ty.bool) (h₂ : HasType b Ty.bool),
  typeCheck a = Maybe.found Ty.bool h₁ → typeCheck b = Maybe.found Ty.bool h₂ → False</span></span></div></blockquote></div></small></div><span class="nv">hnp</span></span><span class="alectryon-token"> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>h₁</var><b>: </b><span>HasType a Ty.bool</span></span></div></blockquote></div></small></div><span class="nv">h₁</span></span><span class="alectryon-token"> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>h₂</var><b>: </b><span>HasType b Ty.bool</span></span></div></blockquote></div></small></div><span class="nv">h₂</span></span><span class="alectryon-token"> (</span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>typeCheck_correct</var><b>: </b><span>∀ {e : Expr} {ty : Ty} {h : HasType e ty}, HasType e ty → typeCheck e ≠ Maybe.unknown → typeCheck e = Maybe.found ty h</span></span></div></blockquote></div></small></div>typeCheck_correct</span><span class="alectryon-token"> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>h₁</var><b>: </b><span>HasType a Ty.bool</span></span></div></blockquote></div></small></div><span class="nv">h₁</span></span><span class="alectryon-token"> (</span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>iha</var><b>: </b><span>typeCheck a = Maybe.unknown → ¬HasType a Ty.bool</span></span></div></blockquote></div></small></div><span class="nv">iha</span></span><span class="alectryon-token"> <span class="bp">·</span> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>h₁</var><b>: </b><span>HasType a Ty.bool</span></span></div></blockquote></div></small></div><span class="nv">h₁</span></span><span class="alectryon-token">)) (</span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>typeCheck_correct</var><b>: </b><span>∀ {e : Expr} {ty : Ty} {h : HasType e ty}, HasType e ty → typeCheck e ≠ Maybe.unknown → typeCheck e = Maybe.found ty h</span></span></div></blockquote></div></small></div>typeCheck_correct</span><span class="alectryon-token"> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>h₂</var><b>: </b><span>HasType b Ty.bool</span></span></div></blockquote></div></small></div><span class="nv">h₂</span></span><span class="alectryon-token"> (</span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>ihb</var><b>: </b><span>typeCheck b = Maybe.unknown → ¬HasType b Ty.bool</span></span></div></blockquote></div></small></div><span class="nv">ihb</span></span><span class="alectryon-token"> <span class="bp">·</span> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>h₂</var><b>: </b><span>HasType b Ty.bool</span></span></div></blockquote></div></small></div><span class="nv">h₂</span></span><span class="alectryon-token">))</span></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion">Goals accomplished<span class="bp">!</span> <span class="bp">🐙</span></div></blockquote></div></div></small></span></pre>
<p>Finally, we show that type checking for <code>e</code> can be decided using <code>Expr.typeCheck</code>.</p>
<pre class="alectryon-io type-info-hidden highlight"><!-- Generator: Alectryon --><span class="alectryon-wsp"><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>instance</var><b>: </b><span>(e : Expr) → (t : Ty) → Decidable (HasType e t)</span></span></div></blockquote></div></small></div><span class="kd">instance</span></span><span class="alectryon-token"> (</span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>e</var><b>: </b><span>Expr</span></span></div></blockquote></div></small></div><span class="nv">e</span></span><span class="alectryon-token"> : </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Expr</var><b>: </b><span>Type</span></span></div></blockquote></div></small></div>Expr</span><span class="alectryon-token">) (</span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>t</var><b>: </b><span>Ty</span></span></div></blockquote></div></small></div><span class="nv">t</span></span><span class="alectryon-token"> : </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Ty</var><b>: </b><span>Type</span></span></div></blockquote></div></small></div>Ty</span><span class="alectryon-token">) : </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Decidable</var><b>: </b><span>Prop → Type</span></span></div></blockquote></div></small></div>Decidable</span><span class="alectryon-token"> (</span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>HasType</var><b>: </b><span>Expr → Ty → Prop</span></span></div></blockquote></div></small></div>HasType</span><span class="alectryon-token"> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>e</var><b>: </b><span>Expr</span></span></div></blockquote></div></small></div><span class="nv">e</span></span><span class="alectryon-token"> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>t</var><b>: </b><span>Ty</span></span></div></blockquote></div></small></div><span class="nv">t</span></span><span class="alectryon-token">) :=
  </span><span class="alectryon-token"><span class="k">match</span></span><span class="alectryon-token"> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>h'</var><b>: </b><span>Expr.typeCheck e = Maybe.unknown</span></span></div></blockquote></div></small></div><span class="nv">h&#39;</span></span><span class="alectryon-token"> : </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>e</var><b>: </b><span>Expr</span></span></div></blockquote></div></small></div><span class="nv">e</span></span><span class="alectryon-token"><span class="bp">.</span></span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>typeCheck</var><b>: </b><span>(e : Expr) → {{ ty | HasType e ty }}</span></span></div></blockquote></div></small></div>typeCheck</span><span class="alectryon-token"> </span><span class="alectryon-token"><span class="k">with</span></span><span class="alectryon-token">
  <span class="bp">|</span> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>.found</var><b>: </b><span>{α : Type} → {p : α → Prop} → (a : α) → p a → Maybe p</span></span></div></blockquote></div></small></div><span class="bp">.</span>found</span><span class="alectryon-token"> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>t'</var><b>: </b><span>Ty</span></span></div></blockquote></div></small></div><span class="nv">t&#39;</span></span><span class="alectryon-token"> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>ht'</var><b>: </b><span>HasType e t'</span></span></div></blockquote></div></small></div><span class="nv">ht&#39;</span></span><span class="alectryon-token"> <span class="bp">=&gt;</span>
    </span><span class="alectryon-token"><span class="k">if</span></span><span class="alectryon-token"> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>heq</var><b>: </b><span>t = t'</span></span></div></blockquote></div></small></div><span class="nv">heq</span></span><span class="alectryon-token"> : </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>t</var><b>: </b><span>Ty</span></span></div></blockquote></div></small></div><span class="nv">t</span></span><span class="alectryon-token"> <span class="bp">=</span> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>t'</var><b>: </b><span>Ty</span></span></div></blockquote></div></small></div><span class="nv">t&#39;</span></span><span class="alectryon-token"> </span><span class="alectryon-token"><span class="k">then</span></span><span class="alectryon-token">
      </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>isTrue</var><b>: </b><span>{p : Prop} → p → Decidable p</span></span></div></blockquote></div></small></div>isTrue</span><span class="alectryon-token"> (</span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>heq</var><b>: </b><span>t = t'</span></span></div></blockquote></div></small></div><span class="nv">heq</span></span><span class="alectryon-token"> <span class="bp">▸</span> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>ht'</var><b>: </b><span>HasType e t'</span></span></div></blockquote></div></small></div><span class="nv">ht&#39;</span></span><span class="alectryon-token">)
    </span><span class="alectryon-token"><span class="k">else</span></span><span class="alectryon-token">
      </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>isFalse</var><b>: </b><span>{p : Prop} → ¬p → Decidable p</span></span></div></blockquote></div></small></div>isFalse</span><span class="alectryon-token"> </span><span class="alectryon-token"><span class="k">fun</span></span><span class="alectryon-token"> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>ht</var><b>: </b><span>HasType e t</span></span></div></blockquote></div></small></div><span class="nv">ht</span></span><span class="alectryon-token"> <span class="bp">=&gt;</span> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>heq</var><b>: </b><span>¬t = t'</span></span></div></blockquote></div></small></div><span class="nv">heq</span></span><span class="alectryon-token"> (</span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>HasType.det</var><b>: </b><span>∀ {e : Expr} {t₁ t₂ : Ty}, HasType e t₁ → HasType e t₂ → t₁ = t₂</span></span></div></blockquote></div></small></div>HasType.det</span><span class="alectryon-token"> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>ht</var><b>: </b><span>HasType e t</span></span></div></blockquote></div></small></div><span class="nv">ht</span></span><span class="alectryon-token"> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>ht'</var><b>: </b><span>HasType e t'</span></span></div></blockquote></div></small></div><span class="nv">ht&#39;</span></span><span class="alectryon-token">)
  <span class="bp">|</span> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>.unknown</var><b>: </b><span>{α : Type} → {p : α → Prop} → Maybe p</span></span></div></blockquote></div></small></div><span class="bp">.</span>unknown</span><span class="alectryon-token"> <span class="bp">=&gt;</span> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>isFalse</var><b>: </b><span>{p : Prop} → ¬p → Decidable p</span></span></div></blockquote></div></small></div>isFalse</span><span class="alectryon-token"> (</span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Expr.typeCheck_complete</var><b>: </b><span>∀ {ty : Ty} {e : Expr}, Expr.typeCheck e = Maybe.unknown → ¬HasType e ty</span></span></div></blockquote></div></small></div>Expr.typeCheck_complete</span><span class="alectryon-token"> </span><span class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>h'</var><b>: </b><span>Expr.typeCheck e = Maybe.unknown</span></span></div></blockquote></div></small></div><span class="nv">h&#39;</span></span><span class="alectryon-token">)</span></span></pre>
                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../examples/bintree.lean.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                            <a rel="next" href="../examples/interp.lean.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../examples/bintree.lean.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                    <a rel="next" href="../examples/interp.lean.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>

        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        <script src="../elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../searcher.js" type="text/javascript" charset="utf-8"></script>
        <script src="../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="../book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        <script type="text/javascript" src="../alectryon.js"></script>
    </body>
</html>
